{# Jinja2 template for SVG diagram generation #}
{# Template Version: 1.0.0 #}

<svg xmlns="http://www.w3.org/2000/svg"
     width="{{ width | default(800) }}"
     height="{{ height | default(600) }}"
     viewBox="0 0 {{ width | default(800) }} {{ height | default(600) }}">

  <!-- Generated by MathpixPipeline Regeneration Engine v2.0 -->

  <defs>
    <!-- Arrow marker for axes -->
    <marker id="arrowhead" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#666"/>
    </marker>

    <!-- Grid pattern -->
    <pattern id="grid" width="{{ grid_size | default(50) }}" height="{{ grid_size | default(50) }}" patternUnits="userSpaceOnUse">
      <path d="M {{ grid_size | default(50) }} 0 L 0 0 0 {{ grid_size | default(50) }}"
            fill="none" stroke="#e0e0e0" stroke-width="1"/>
    </pattern>
  </defs>

  <!-- Background -->
  <rect width="100%" height="100%" fill="{{ bg_color | default('#ffffff') }}"/>

  {% if show_grid | default(false) %}
  <!-- Grid -->
  <rect width="100%" height="100%" fill="url(#grid)"/>
  {% endif %}

  {% if show_axes | default(true) %}
  <!-- Axes -->
  <g class="axes">
    <!-- X-axis -->
    <line x1="{{ margin | default(50) }}"
          y1="{{ height | default(600) / 2 }}"
          x2="{{ width | default(800) - margin | default(50) }}"
          y2="{{ height | default(600) / 2 }}"
          stroke="#666" stroke-width="1.5" marker-end="url(#arrowhead)"/>

    <!-- Y-axis -->
    <line x1="{{ width | default(800) / 2 }}"
          y1="{{ height | default(600) - margin | default(50) }}"
          x2="{{ width | default(800) / 2 }}"
          y2="{{ margin | default(50) }}"
          stroke="#666" stroke-width="1.5" marker-end="url(#arrowhead)"/>

    <!-- Axis labels -->
    <text x="{{ width | default(800) - margin | default(50) - 15 }}"
          y="{{ height | default(600) / 2 + 20 }}"
          font-family="{{ font_family | default('Arial, sans-serif') }}"
          font-size="14" fill="#666">x</text>

    <text x="{{ width | default(800) / 2 + 10 }}"
          y="{{ margin | default(50) + 15 }}"
          font-family="{{ font_family | default('Arial, sans-serif') }}"
          font-size="14" fill="#666">y</text>
  </g>
  {% endif %}

  <!-- Content -->
  <g class="content">
    {% for node in nodes %}
    {% if node.node_type == "point" and node.properties.coordinates %}
    <!-- Point: {{ node.label }} -->
    <circle cx="{{ (node.properties.coordinates.x * scale | default(50)) + (width | default(800) / 2) }}"
            cy="{{ (height | default(600) / 2) - (node.properties.coordinates.y * scale | default(50)) }}"
            r="4" fill="{{ point_color | default('#2196F3') }}"/>
    <text x="{{ (node.properties.coordinates.x * scale | default(50)) + (width | default(800) / 2) + 8 }}"
          y="{{ (height | default(600) / 2) - (node.properties.coordinates.y * scale | default(50)) - 8 }}"
          font-family="{{ font_family | default('Arial, sans-serif') }}"
          font-size="{{ font_size | default(14) }}" fill="#333">{{ node.properties.point_label | default(node.label) }}</text>

    {% elif node.node_type == "circle" and node.properties.center and node.properties.radius %}
    <!-- Circle: {{ node.label }} -->
    <circle cx="{{ (node.properties.center.x * scale | default(50)) + (width | default(800) / 2) }}"
            cy="{{ (height | default(600) / 2) - (node.properties.center.y * scale | default(50)) }}"
            r="{{ node.properties.radius * scale | default(50) }}"
            stroke="{{ circle_color | default('#E91E63') }}" stroke-width="2" fill="none"/>

    {% elif node.node_type == "label" and node.bbox %}
    <!-- Label: {{ node.label }} -->
    <text x="{{ node.bbox.x }}" y="{{ node.bbox.y }}"
          font-family="{{ font_family | default('Arial, sans-serif') }}"
          font-size="{{ font_size | default(14) }}" fill="#333">{{ node.label }}</text>
    {% endif %}
    {% endfor %}
  </g>

</svg>
