# =============================================================================
# Mathpix SuperNet Architecture Overview
# =============================================================================
# Version: 1.0.0
# Date: 2026-02-04
# Source: https://mathpix.com/blog/supernet
# Purpose: Machine-Readable SuperNet model documentation for Claude
# =============================================================================

---
metadata:
  file_index: "00/05"
  description: "SuperNet layout parsing model overview"
  source_url: "https://mathpix.com/blog/supernet"

# =============================================================================
# SUPERNET OVERVIEW
# =============================================================================
supernet:
  name: "SuperNet"
  type: "Layout Parsing Model"
  description: |
    SuperNet is Mathpix's latest unified layout parsing model that consolidates
    multiple specialized models (table parser, PDF page parser) into a single
    larger, more capable model.

  # ---------------------------------------------------------------------------
  # KEY CHARACTERISTICS
  # ---------------------------------------------------------------------------
  characteristics:
    unified_model: true
    description: "Replaces multiple specialized models with one unified model"
    benefits:
      - "Faster deployment of improvements"
      - "Improved accuracy across all document types"
      - "Consistent behavior across different content types"

  # ---------------------------------------------------------------------------
  # CAPABILITIES
  # ---------------------------------------------------------------------------
  capabilities:
    diagram_text_parsing:
      description: "Parse text fragments within diagrams"
      api_parameter: "include_diagram_text"
      default: false
      cow_setting: true  # COW Pipeline enables this

    pdf_parsing:
      description: "Enhanced PDF page parsing accuracy"
      automatic: true
      no_parameter_needed: true

    table_parsing:
      description: "Improved table structure recognition"
      automatic: true
      includes:
        - "Diagonal split cells"
        - "Complex merged cells"
        - "Multi-column layouts"

    code_recognition:
      description: "Enhanced code and pseudocode detection"
      automatic: true
      line_types:
        - "code"
        - "pseudocode"

    rotation_handling:
      description: "Better handling of rotated images and PDF pages"
      api_parameter: "auto_rotate_confidence_threshold"
      default: 0.99

  # ---------------------------------------------------------------------------
  # API USAGE
  # ---------------------------------------------------------------------------
  api_usage:
    activation:
      method: "AUTOMATIC"
      description: "SuperNet is automatically used for all API calls"
      note: "No explicit model selection parameter exists"

    endpoints_using_supernet:
      - "/v3/text"
      - "/v3/pdf"
      - "/v3/strokes"

    optional_features:
      include_diagram_text:
        description: "Enable diagram text extraction (SuperNet feature)"
        default: false
        recommendation: "Set to true for math problems with diagrams"

      enable_tables_fallback:
        description: "Enable advanced table processing"
        default: false
        recommendation: "Set to true for complex tables"

  # ---------------------------------------------------------------------------
  # VERSION HISTORY
  # ---------------------------------------------------------------------------
  version_history:
    current: "SuperNet-109p6"
    release_date: "2025-12-24"

    major_milestones:
      SuperNet-100:
        date: "2025-04-04"
        highlights:
          - "Initial SuperNet release"
          - "Unified layout parsing model"

      SuperNet-105:
        date: "2025-08-04"
        highlights:
          - "figure_label line type added"
          - "selected_labels field added"
          - "Enhanced table parsing"

      SuperNet-109:
        date: "2025-12-09"
        highlights:
          - "Latest stable release"
          - "Improved confidence scoring"

  # ---------------------------------------------------------------------------
  # COW PIPELINE INTEGRATION
  # ---------------------------------------------------------------------------
  cow_integration:
    config_file: "pipeline/stage_b/mathpix_config.py"

    enabled_supernet_features:
      include_diagram_text: true
      include_geometry_data: true
      enable_tables_fallback: true

    note: |
      COW Pipeline Stage B is configured to utilize SuperNet's advanced
      features including diagram text extraction and enhanced table parsing.

# =============================================================================
# IMPORTANT NOTES FOR CLAUDE
# =============================================================================
important_notes:
  - note: "SuperNet is NOT a separate API endpoint"
    detail: "It's the backend model automatically used for all calls"

  - note: "No model selection parameter exists"
    detail: "Cannot choose between SuperNet and older models"

  - note: "Version appears in response metadata"
    detail: "Check 'version' field in API response for model version"

  - note: "Changelog versions indicate SuperNet updates"
    pattern: "SuperNet-###p# (e.g., SuperNet-109p6)"
