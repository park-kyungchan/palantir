# TRACE Methodology Implementation (Reflective Analysis Engine)

## Overview
The Reflective Analysis Engine, implemented in `scripts/ontology/learning.py`, automates the "Codebase-as-Curriculum" phase of the Palantir FDE Learning System. It uses the TRACE framework to decompose codebases into structured learning units.

## TRACE Framework Phases

### 1. T - Trace Entry Points
- Identifies execution starting points (e.g., `main()`, `index.ts`).
- Maps directory structure to architectural layers:
    - **Domain**: Ontology, types, models.
    - **Infrastructure**: Database, storage, API.
    - **Application**: Business logic, controllers (Default).

### 2. R - Recognize Patterns
Uses regex-based pattern matching to identify technical concepts and map them to Knowledge Bases (KBs).

| Pattern Identifier | Regex Signal | Concept | KB Reference |
| :--- | :--- | :--- | :--- |
| `KB_20` | `new Map<`, `dict(` | Hash Maps / Caching | 20_dsa_hash_maps |
| `KB_21` | `TreeNode`, `left:` | Trees / Graphs | 21_dsa_trees_graphs |
| `KB_22` | `memo[`, `dp[` | Dynamic Programming | 22_dsa_dynamic_programming |
| `KB_00d` | `async def`, `await` | Async Concurrency | 00d_async_basics |
| `KB_00e` | `interface`, `<T>` | Type Safety | 00e_typescript_intro |
| `KB_11_OSDK` | `createClient`, `export default async function` | Palantir OSDK / Functions v2 | 11_osdk_typescript |
| `KB_02_React` | `useState`, `useEffect` | React Hooks | 02_react_ecosystem |

### 3. A - Analyze Data Flow
- Scans both source code (`.py`, `.ts`, `.js`) and documentation (`.md`).
- Recognizes "FDE Knowledge Artifacts" by header presence (e.g., "# Universal Concept").

### 4. C - Catalog Dependencies
- Groups identified patterns by file and module.

### 5. E - Extract Learning Units
- Generates a standardized XML `<codebase_analysis>` manifest.

## Output Structure (XML)
```xml
<codebase_analysis>
  <architecture_overview>
    <layer name="Domain">X files</layer>
  </architecture_overview>
  <module_breakdown>
    <module name="filename" path="path/to/file">
      <description>Implements Concept A, Concept B</description>
      <kb_map>...</kb_map>
    </module>
  </module_breakdown>
  <key_patterns>
    <pattern name="Concept A">
      <file>...</file>
      <kb_ref>...</kb_ref>
    </pattern>
  </key_patterns>
</codebase_analysis>
```
