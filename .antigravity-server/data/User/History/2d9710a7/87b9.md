# Orion ODA Workspace Reorganization

## Overview
The Orion Ontology-Driven Architecture (ODA) workspace has undergone a cyclical evolution. Initially organized under `/home/palantir/orion-orchestrator-v2/`, it was briefly migrated to the root `/home/palantir/` for consolidation. However, in January 2026, the **orion-orchestrator-v2** structure was re-established as the categorical project root to align with legacy development patterns and user structural preferences.

## Key Changes

### 1. Hoisting the Core
All core directories are moved from the sub-directory to the root:
- `/scripts/`: The ODA kernel and MCP servers.
- `/config/`: System and environment settings.
- `/coding/` & `/governance/`: specialized ODA domains.

### 2. Path Redirection
- **MCP Configuration**: The `mcp_config.json` is updated to point to `/home/palantir/` instead of `orion-orchestrator-v2`.
- **PYTHONPATH**: Python tools now use the root as the base package directory.

### 3. Agent Metadata Consolidation
The `.agent/` directory at the root is the single source of truth:
- **Backup**: Before merging, a full backup of the root `.agent` was created. After verifying the root-based ODA stability, these backups (e.g., `/home/palantir/.agent_backup_20260104_103717/`) were deleted to maintain environment cleanliness.
- **Rules & Workflows**: Merged from the repository (`orion-orchestrator-v2/.agent/`) to the root `.agent/`.
- **Handoffs**: Migrated to the root `.agent/handoffs`.
- **Persistence**: Runtime databases (e.g., `orion_ontology.db`) and logs are maintained at the root.

### .agent/ Directory structure
The `.agent/` directory serves as the ODA's persistence and governance layer:
- `rules/`: Governance rules (kernel_v5, domain, governance).
- `workflows/`: Step-by-step procedural guides (00_start.md to 07_memory_sync.md).
- `schemas/`: Data models and validation logic.
- `logs/`: High-level execution and audit logs.
- `indexes/`: File and knowledge markers.
- `handoffs/`: Context transfer artifacts.
- `orion_ontology.db`: The core SQLite database for ontology state and proposal persistence.

### 5. Antigravity & Metadata Directories
The environment contains specialized directories for LLM-specific persistence and cross-session memory:
- **.gemini/**: Primary storage for Gemini-specific context, brain artifacts, and code trackers.
- **.antigravity/**: Traditionally expected at the root for Antigravity-specific settings. 
- **Symlink Strategy**: To maintain IDE compatibility while preserving existing data, a symlink is used: `.antigravity -> .gemini/antigravity`.
- **Restoration**: In case of a `git reset --hard` or accidental deletion, the link must be recreated to reconcile the system's "Brain" with the active workspace.

### 6. Sub-Directory Consolidation (Jan 5, 2026)
To further organize the multi-user environment and preserve historical continuity, the workspace was migrated into a user-specific subdirectory: `/home/palantir/park-kyungchan/palantir/`.
- **Source**: Upstream repository `orion-orchestrator-v2` history was cloned and merged.
- **Placement**: Legacy root-level folders (`cow/`, `hwpx/`, etc.) and redundant clones were deleted.
- **State**: The project now operates from `park-kyungchan/palantir/`, initialized at the Jan 4, 10:00 AM state (`e4eb473`).

## Architectural Rationale
Consolidating into a user-specific subdirectory (`park-kyungchan/`) prevents workspace clutter and ensures that the ODA has a dedicated, version-controlled environment while keeping the root `/home/palantir/` clean for system and metadata operations.

## Terminal & Environment Compatibility
The ODA is designed to be compatible with standard terminal environments (e.g., Ubuntu Terminal) assuming the following conditions are met:
- **User Home**: The system relies on absolute paths rooted in `/home/palantir/`. 
- **Active Project Root**: The core project resides in `/home/palantir/park-kyungchan/palantir/`.
- **Dynamic Pathing**: Core scripts (e.g., `database.py`, `handoff.py`, `lifecycle_manager.py`) use the **Cross-Environment Compatibility Pattern**. They resolve the `.agent/` persistence location dynamically, ensuring consistency between the IDE and standard terminals.
- **Python Environment**: The `/home/palantir/.venv` must contain the mandatory dependencies (`mcp`, `aiosqlite`, `sqlalchemy`, `instructor`, `prometheus_client`).
- **Integration**: The ODA can be safely managed via CLI as long as the pathing correctly identifies the `park-kyungchan` nesting.
