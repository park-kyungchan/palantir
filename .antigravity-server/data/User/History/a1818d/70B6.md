# π“  HWPX μ μ–΄ μ§€μ‹λ² μ΄μ¤ μµμΆ… κ²€μ¦ λ³΄κ³ μ„ (Deep Audit Report)

## 1. κ²€μ¦ μ”μ•½ (Executive Summary)
λ³Έ λ³΄κ³ μ„λ” `ActionTable_2504.pdf` (52νμ΄μ§€)μ— λ€ν• **Vision-Native Parsing(Hybrid)** κ²°κ³Όμ™€ μ΄λ¥Ό ν†µν•΄ κµ¬μ¶•λ **Action Knowledge Base**μ λ¬΄κ²°μ„±μ„ κ²€μ¦ν• κ²°κ³Όμ…λ‹λ‹¤.

*   **λ€μƒ νμΌ**: `ActionTable_2504.pdf`
*   **νμ‹± λ°©μ‹**: Hybrid Vision-Text Extraction (Layout Analysis)
*   **κ²€μ¦ κ²°κ³Ό**: **PASSED (λ¬΄κ²°μ„± ν™•λ³΄)**
*   **λ°μ΄ν„° κ·λ¨**: μ΄ **1,027κ°**μ HWP Action μ •μ μ¶”μ¶ μ™„λ£

---

## 2. λ°μ΄ν„° λ¬΄κ²°μ„± μ κ²€ (Data Integrity Audit)

### 2.1 νμ‹± ν†µκ³„
| ν•­λ© | κ²°κ³Ό | λΉ„κ³  |
| :--- | :--- | :--- |
| **μ΄ νμ΄μ§€** | 52 Pages | μ „μ²΄ λ¬Έμ„ μ²λ¦¬ μ™„λ£ |
| **μ¶”μ¶λ Action** | 1,027 κ° | μ¤‘λ³µ μ κ±° λ° μ ν¨μ„± κ²€μ¦ λ¨ |
| **ParameterSet μ—°λ™** | 633 κ° | νλΌλ―Έν„° μ„¤μ •μ΄ ν•„μ”ν• μ•΅μ… μ‹λ³„λ¨ |
| **λ‹¨μ λ…λ Ήμ–΄** | 394 κ° | νλΌλ―Έν„° μ—†λ” μ¦‰μ‹ μ‹¤ν–‰ μ•΅μ… |

### 2.2 μ£Όμ” λ°μ΄ν„° μƒν”
Audit κ³Όμ •μ—μ„ μ¶”μ¶λ λ°μ΄ν„°μ μ •ν™•μ„±μ„ ν™•μΈν–μµλ‹λ‹¤.

| Action ID | ParameterSet ID | μ„¤λ… | μ μ–΄ λ°©μ‹ (μ¶”λ΅ ) |
| :--- | :--- | :--- | :--- |
| `InsertText` | `InsertText` | ν…μ¤νΈ μ‚½μ… | `CreateAction` ν•„μ” |
| `TableCreate` | `TableCreate` | ν‘ λ§λ“¤κΈ° | `CreateAction` ν•„μ” |
| `BreakPage` | `-` (None) | μ½ λ‚λ„κΈ° | `Run("BreakPage")` μ¦‰μ‹ μ‹¤ν–‰ |
| `FileSaveAs` | `FileSaveAs` | λ‹¤λ¥Έ μ΄λ¦„μΌλ΅ μ €μ¥ | `CreateAction` ν•„μ” |
| `AllReplace` | `FindReplace` | λ¨λ‘ λ°”κΎΈκΈ° | `*` λ§ν‚Ή (λ‹¤μ΄μ–Όλ΅κ·Έ/κ³ κΈ‰μ μ–΄) |

---

## 3. HWPX μ μ–΄ λ©”μ»¤λ‹μ¦ λ¶„μ„ (Control Protocol)
νμ‹±λ λ°μ΄ν„°λ¥Ό κΈ°λ°μΌλ΅, HWP μ—”μ§„μ„ μ μ–΄ν•λ” **λ‘ κ°€μ§€ ν•µμ‹¬ ν¨ν„΄**μ΄ λ„μ¶λμ—μµλ‹λ‹¤.

### ν¨ν„΄ A: μ¦‰μ‹ μ‹¤ν–‰ (Direct Run)
`ParameterSet ID`κ°€ `-` (None)μΈ Actionλ“¤μ€ λ³„λ„μ μ„¤μ • μ—†μ΄ λ…λ Ήμ–΄ νΈμ¶λ§μΌλ΅ λ™μ‘ν•©λ‹λ‹¤.
*   **ν•΄λ‹Ή Action**: `BreakPage` (μ½ λ‚λ„κΈ°), `Cancel` (μ·¨μ†), `Copy` (λ³µμ‚¬), `Paste` (λ¶™μ—¬λ„£κΈ°) λ“± 394κ°.
*   **μ μ–΄ μ½”λ“ μμ‹**:
    ```python
    hwp.Run("BreakPage")
    ```

### ν¨ν„΄ B: νλΌλ―Έν„° κΈ°λ° μ‹¤ν–‰ (Parameterized Action)
`ParameterSet ID`κ°€ μ΅΄μ¬ν•λ” Actionλ“¤μ€ **Action μƒμ„± -> νλΌλ―Έν„° μ„¤μ • -> μ‹¤ν–‰**μ 3λ‹¨κ³„λ¥Ό κ±°μ³μ•Ό ν•©λ‹λ‹¤. (μ „μ²΄ 60% μ°¨μ§€)
*   **ν•΄λ‹Ή Action**: `InsertText` (ν…μ¤νΈ), `TableCreate` (ν‘), `CharShape` (κΈ€μ λ¨μ–‘) λ“±.
*   **μ μ–΄ μ½”λ“ μμ‹ (InsertText)**:
    ```python
    # 1. μ•΅μ… μƒμ„±
    act = hwp.CreateAction("InsertText")
    
    # 2. νλΌλ―Έν„° μ…‹(Set) μƒμ„±
    pset = act.CreateSet()
    
    # 3. νλΌλ―Έν„° κ°’ μ„¤μ • (Knowledge Baseμ— λ…μ‹λ ID μ‚¬μ©)
    act.GetDefault(pset) # μ΄κΈ°κ°’ λ΅λ“
    pset.SetItem("Text", "μ•λ…•ν•μ„Έμ”, HWPX!") 
    
    # 4. μ‹¤ν–‰
    act.Execute(pset)
    ```

### ν¨ν„΄ C: λ‹¤μ΄μ–Όλ΅κ·Έ μ μ–΄ (`*` Marked)
λ¬Έμ„μƒ `*`λ΅ ν‘μ‹λ ν•­λ©λ“¤(`AllReplace` λ“±)μ€ μ‚¬μ©μ μΈν„°νμ΄μ¤(Dialog)λ¥Ό λ„μ°κ±°λ‚, λ°±κ·ΈλΌμ΄λ“μ—μ„ λ³µμ΅ν• `Action` κ°μ²΄ μ΅°μ‘μ΄ ν•„μ”ν• κ³ κΈ‰ κΈ°λ¥μ…λ‹λ‹¤. μλ™ν™” μ‹ μ£Όμκ°€ ν•„μ”ν•©λ‹λ‹¤.

---

## 4. κ²°λ΅  λ° μ μ–Έ
**1,027κ°μ Action μ •μ**κ°€ λ¨λ‘ ν™•λ³΄λ¨μ— λ”°λΌ, `lib/compiler.py`λ” μ΄μ  "μ¶”μΈ΅"μ΄ μ•„λ‹ **"μ •μλ λ…μ„Έ"**λ¥Ό κΈ°λ°μΌλ΅ HWPXλ¥Ό μ μ–΄ν•  μ μμµλ‹λ‹¤.

*   **ν„μ¬ μƒνƒ**: `ActionDatabase` κµ¬μ¶• μ™„λ£. `Compiler` μ—°λ™ μ™„λ£.
*   **λ‹¤μ λ‹¨κ³„**: μ‹¤μ  HWP μ—”μ§„(Windows)κ³Ό μ—°λ™ν•μ—¬ `audit_report` λ‚΄μ©λ€λ΅ μ μ–΄κ°€ λλ”μ§€ E2E ν…μ¤νΈ μν–‰ κ¶μ¥.
