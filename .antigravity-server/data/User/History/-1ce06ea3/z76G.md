# Implementation: API Reference Extraction

The HWPX Knowledge Base contains the full API surface of the Hancom Office Automation Object, enabling the system to fulfill complex document manipulation requirements.

## 1. Extraction Methodology
The `APIIngestor` (`lib/ingestors/api_ingestor.py`) processed the 69-page `HwpAutomation_2504.pdf` manual.
- **Strategy**: Layout-based text analysis.
- **Identification**: Anchored on the characteristic `(Method)` and `(Property)` labels found in the official documentation.
- **Total Surface**: **138 Methods** and **223 Properties**.

## 2. Core API Surface (Highlights)

### 2.1 Essential Methods
| Method | Description |
| :--- | :--- |
| **Open** | Opens a document file with specified format and options. |
| **SaveAs** | Saves the current document to a file. |
| **Insert** | Inserts an external file at the current caret position. |
| **MovePos** | Navigates the caret based on Move-ID (e.g., StartOfLine, EndOfDoc). |
| **InitScan** / **ReleaseScan** | Initiates/Terminates text scanning for data extraction. |
| **GetFieldText** / **PutFieldText** | Retrieves or updates text in form fields/bookmarks. |
| **Run** | Executes a named Action (Shortcut to `HAction.Run`). |

### 2.2 Critical Properties
| Property | Type | Description |
| :--- | :--- | :--- |
| **IsModified** | Boolean | Indicates if the document has unsaved changes. |
| **PageCount** | Integer | Returns the total number of pages after pagination. |
| **EditMode** | Integer | Controls read-only vs. read/write access. |
| **CharShape** | Object | Provides quick access to character style parameters. |
| **ParaShape** | Object | Provides quick access to paragraph style parameters. |
| **XHwpDocuments** | Collection | Entry point for multi-document management. |

## 3. Storage & Integration
Extracted members are stored in the `methods` and `properties` dictionaries within the `ActionDatabase` schema:

```python
class APIMethodDefinition(BaseModel):
    name: str
    description: Optional[str] = None
    args: Optional[str] = None

class APIPropertyDefinition(BaseModel):
    name: str
    description: Optional[str] = None
    type: Optional[str] = None
```

This comprehensive registry allows the `Compiler` to not only execute discrete "Actions" (like `CreateTable`) but also perform lower-level API calls (like `MoveToField`) to satisfy granular user requirements.
