# Implementation Plan - XLSX Structure Analysis

## Goal
To analyze the structure (schema, metadata, content stats) of all `.xlsx` files originating from the provided Google Drive folder.
The goal is to understand the dataset's composition to inform downstream processing (e.g., ingestion, reconstruction).

## User Review Required
> [!IMPORTANT]
> **Data Access**: This plan assumes the files from the Google Drive link are **downloaded locally** to a specific directory (e.g., `data/raw/xlsx_source`). The script will operate on local files.

## Proposed Changes

### Scripts
#### [NEW] [analyze_xlsx_structure.py](file:///home/palantir/park-kyungchan/palantir/scripts/analyze_xlsx_structure.py)
- **Purpose**: Recursively scan a directory for `.xlsx` files and generate a structure report.
- **Key Features**:
    - **Discovery**: Walk directory tree.
    - **Extraction**:
        - File metadata (size, path).
        - Workbook metadata (sheet names).
        - Sheet stats (row count, column headers, inferred data types).
    - **Aggregation**: Summarize findings (e.g., "Common Schemas", "Outliers").
    - **Output**: JSON report and Markdown summary.
- **Dependencies**: `pandas`, `openpyxl`.

### Configuration
#### [MODIFY] [requirements.txt](file:///home/palantir/park-kyungchan/palantir/requirements.txt)
- Verified: `pandas==2.3.3` and `openpyxl==3.1.5` are already installed in the environment. No changes needed.

## Verification Plan

### Automated Tests
- **Unit Test**: Create a test that generates a temporary dummy `.xlsx` file, runs the analyzer, and asserts the output JSON structure.
    - Command: `pytest tests/test_xlsx_analysis.py`

### Manual Verification
1.  **Setup**: Install dependencies (`pip install pandas openpyxl`).
2.  **Data Prep**: Place a sample `.xlsx` file in `data/sample`.
3.  **Execution**: Run `python scripts/analyze_xlsx_structure.py --input data/sample --output report.json`.
4.  **Validation**: Check `report.json` for correct sheet names and column headers.
