# HwpUnit Conversion Specification

## 1. Dimensional Standard (1/7200 inch)
HWPX (OWPML) uses **HwpUnit** as its internal coordinate system. 
- **1 HwpUnit = 1/7200 inch**
- **100 HwpUnit = 1 pt** (since 1 pt = 1/72 inch)

## 2. Conversion Table

| Unit | Conversion to HwpUnit | Example |
| :--- | :--- | :--- |
| **Millimeter (mm)** | `round(mm * 283.46457)` | 1mm â‰ˆ 283 HwpUnit |
| **Point (pt)** | `round(pt * 100)` | 10pt = 1000 HwpUnit |
| **Inch (in)** | `round(inch * 7200)` | 1 inch = 7200 HwpUnit |
| **Pixel (96 DPI)** | `round((px / 96) * 7200)` | 96px = 7200 HwpUnit |

## 3. Implementation Patterns (`lib/owpml/units.py`)

The following logic is implemented to ensure precision across the pipeline:

```python
HWPUNIT_PER_INCH = 7200
HWPUNIT_PER_PT = 100
HWPUNIT_PER_MM = 283.46457

def mm_to_hwpunit(mm):
    return round(mm * HWPUNIT_PER_MM)

def pt_to_hwpunit(pt):
    return round(pt * HWPUNIT_PER_PT)
```

## 4. Key Considerations
- **Rounding**: All HWPX XML attributes for dimensions (widths, heights, margins) MUST be integers. Always round to the nearest whole number.
- **DPI awareness**: When converting from vision/OCR pixels, the DPI of the source image must be known (standard HWPX assumes 96 DPI for layout previews).
- **Logical Tracking**: HWPX excludes "ghost cells" in merged areas, making logical coordinate tracking (`cellAddr`) essential when calculating cell widths in complex tables.
