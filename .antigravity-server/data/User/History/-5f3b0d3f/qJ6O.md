# Implementation: Action Knowledge Base Parsing

To enable intelligent automation, the system parses the HWP Action Table PDF into a structured **Action Database**. This database provides the look-up table for HWP Action IDs and their associated ParameterSets.

## 1. Data Source
The primary source is `ActionTable_2504.pdf`, a reference manual provided by Hancom. It contains tables mapping "Action IDs" to internal "ParameterSet IDs" and descriptions.

## 2. Parsing Logic (`ActionTableParser`)

The `ActionTableParser` (`lib/knowledge/parser.py`) consumes the "Digital Twin" JSON generated by the **Hybrid Ingestor**.

### 2.1 Table Identification
The parser looks for blocks with `type="table"`. It identifies the columns based on headers (or position):
- **Action ID**: The unique mnemonic for the HWP action (e.g., `AddHanjaWord`).
- **ParameterSet ID**: The ID of the parameter set required for the action (e.g., `FindReplace`).
- **Description**: Korean description of the action's purpose.

### 2.2 Symbol Resolution
The parser handles specific symbols found in the Action Table:
- `+`: Indicates that the action is functional and has a primary role.
- `-`: Indicates a secondary or internal action.
- `*`: Indicates that the ParameterSet is used indirectly or as a specialized subset.

### 2.3 Schema Mapping
Each row is transformed into an `ActionDefinition` Pydantic model:
```python
class ActionDefinition(BaseModel):
    action_id: str
    parameter_set_id: Optional[str]
    description_ko: str
    run_blocked: bool = False
```

## 3. Integration with Compiler
The resulting `ActionDatabase` is used by the `Compiler` to:
1. **Validate Intent**: Ensure a requested action exists in the HWP API.
2. **Retrieve Parameters**: Automatically determine which `ParameterSet` object needs to be instantiated on the Windows side.
3. **Generate OLE Code**: Map the mnemonic `ActionID` to the HWP `CreateAction` and `Execute` calls via the OLE bridge.
