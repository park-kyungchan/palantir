# Draft: Commands/Skills ê³ ë„í™” (Native Capabilities ìµœëŒ€ í™œìš©)

> **Version:** 2.4.0 | **Status:** âœ… ROUND 1-21 DECIDED | **Date:** 2026-01-21
> **Auto-Compact Safe:** This file persists across context compaction
> **Related Plan:** `.agent/plans/progressive_disclosure_l1l2_v2.3.md` (âœ… IMPLEMENTED)

---

## INDEX

### ìš”êµ¬ì‚¬í•­ ìš”ì•½
ë‚¨ì€ Commands (4ê°œ) + Skills (3ê°œ)ë¥¼ Claude Code Native Capabilities ìµœëŒ€ í™œìš©í•˜ì—¬ ê³ ë„í™”:
- `resume`, `run_in_background=true`, `context: fork` ë“± ì ê·¹ í™œìš©
- L1/L2 íŒ¨í„´ ì ìš© (ì´ë¯¸ Hookìœ¼ë¡œ ìë™ ì ìš©ë¨)
- ìµœì‹  V2.1.12+ ê¸°ëŠ¥ ì ê·¹ í†µí•©

### Complexity
- **ì˜ˆìƒ ë³µì¡ë„:** medium
- **ëŒ€ìƒ íŒŒì¼:** 7ê°œ (ì¤‘ë³µ ì œê±° ì‹œ 5ê°œ)

### êµ¬í˜„ í˜„í™© (Implementation Status)

| Round | ê¸°ëŠ¥ | ìƒíƒœ | êµ¬í˜„ íŒŒì¼ |
|-------|------|------|----------|
| 2 | `resume` Parameter | âœ… Decided | Plan íŒŒì¼ ì°¸ì¡° |
| 3 | `run_in_background=true` | âœ… Implemented | `pre-task-inject.sh` |
| 4 | `context: fork` | âœ… Decided | /ask, /plan-draftëŠ” standard |
| 5 | `model` Parameter | âœ… Decided | Opus ëª…ì‹œ |
| 6 | `updatedInput` (Hook) | âœ… Implemented | `pre-task-inject.sh` |
| 7 | `additionalContext` (Hook) | âœ… Implemented | `pre-task-inject.sh` (ë¶„ê¸° ì²˜ë¦¬) |
| 9 | `PostToolUse` Hook | âœ… Implemented | `post-task-output.sh` |
| 10 | `Stop` Hook | â³ Pending | êµ¬í˜„ ì˜ˆì • |
| 11 | `SubagentStop` Hook | â³ Pending | êµ¬í˜„ ì˜ˆì • |
| 12 | `UserPromptSubmit` Hook | â³ Pending | êµ¬í˜„ ì˜ˆì • |
| 13 | `PermissionRequest` Hook | âŒ ì‚¬ìš© ì•ˆ í•¨ | - |
| 14 | `Notification` Hook | âŒ ì‚¬ìš© ì•ˆ í•¨ | - |
| 15 | `SessionStart` Hook | â³ Pending | Draft ë³µêµ¬ ì•Œë¦¼ ì¶”ê°€ ì˜ˆì • |
| 16 | `SessionEnd` Hook | âŒ ì‚¬ìš© ì•ˆ í•¨ | - |
| 17 | `PreCompact` Hook | â³ Pending | êµ¬í˜„ ì˜ˆì • |
| 18 | `allowed-tools` | âœ… Decided | ì „ì²´ í—ˆìš© |
| 19 | Progressive Disclosure | âœ… Implemented | `pre-task-inject.sh`, `CLAUDE.md` |
| 20 | `max_turns` Parameter | âœ… Decided | `pre-task-inject.sh` (êµ¬í˜„ ì˜ˆì •) |
| 21 | `description` Pattern | âœ… Decided | Documentation only |

### ë‹¤ìŒ ë‹¨ê³„
- Round 20 êµ¬í˜„: Hookì— subagent_typeë³„ max_turns ìë™ ì£¼ì…
- Round 21 êµ¬í˜„: Description íŒ¨í„´ ê°€ì´ë“œë¼ì¸ ë¬¸ì„œí™”

---

## DECISION LOG: Roundë³„ ìƒì„¸ ê¸°ë¡

### ğŸ“‹ Round 1: í•µì‹¬ ìš”êµ¬ì‚¬í•­ ì •ë¦¬ (2026-01-20 21:40)

**ë°°ê²½:**
- ì‚¬ìš©ìê°€ ëª…ì‹œì ìœ¼ë¡œ ì»¤ë§¨ë“œ/ìŠ¤í‚¬ ì‚¬ìš© ì‹œ Native Capabilities ìµœëŒ€ í™œìš© ì›í•¨
- claude-code-guideë¡œ ìµœì‹  ê¸°ëŠ¥ ì¡°ì‚¬ ì™„ë£Œ

**Q&A:**
| ì§ˆë¬¸ | ë‹µë³€ |
|------|------|
| Commands/Skills ì¤‘ë³µ íŒŒì¼ ì²˜ë¦¬? | ë¶„ë¦¬ ìœ ì§€. /ask, /plan-draftë§Œ ê³ ë„í™” |
| ìš°ì„ ìˆœìœ„? | ëª¨ë“  Native-Subagentsì™€ /ask, /plan-draftë§Œ ì§„í–‰ |
| context:fork ì „ëµ? | ëª¨ë“  Subagent í˜¸ì¶œì— fork ì ìš© (ë‚˜ì¤‘ì— Round 4ì—ì„œ ìˆ˜ì •) |
| Hook ì¶”ê°€ ê¸°ëŠ¥ í•„ìš”? | claude-code-guide ì¶”ê°€ ì¡°ì‚¬ ì™„ë£Œ |

**í•µì‹¬ ìš”êµ¬ì‚¬í•­ (í™•ì •):**
1. ì»¤ë§¨ë“œë¡œ í”„ë¡¬í”„íŠ¸ ì…ë ¥ ì‹œ **í•­ìƒ Task() í˜¸ì¶œ**í•˜ì—¬ Hookì´ ì‘ë™í•˜ë„ë¡
2. ëª¨ë“  Subagentì— **context: fork** ì ìš© â†’ (Round 4ì—ì„œ ëŒ€í™”í˜•ì€ standardë¡œ ìˆ˜ì •)
3. Native Capabilities **ìµœëŒ€ í™œìš©** (resume, run_in_background, etc.)

---

### ğŸ“‹ Round 2: `resume` Parameter (2026-01-20 22:05)

**ê¸°ëŠ¥ ì„¤ëª…:**
Auto-Compact í›„ subagent ì‘ì—… ì¬ê°œ. ì´ì „ ì»¨í…ìŠ¤íŠ¸ ë³µì›.

```python
# ì²« ì‹¤í–‰ ì‹œ agent_id ë°˜í™˜ë¨
result = Task(subagent_type="Explore", prompt="...", run_in_background=True)
# â†’ agent_id: "a1b2c3d"

# Auto-Compact í›„ ì¬ê°œ
Task(subagent_type="Explore", prompt="Continue analysis", resume="a1b2c3d")
```

**Claude ì¶”ì²œ:**
| ëŒ€ìƒ | ì¶”ì²œ | ê·¼ê±° |
|------|------|------|
| /ask | âš ï¸ ì„ íƒì  | ëŒ€ë¶€ë¶„ ë‹¨ì¼ í„´ ì™„ë£Œ |
| /plan-draft | âœ… í•„ìš” | ì—¬ëŸ¬ ë¼ìš´ë“œ Q&A |

**ì¶”ì²œ ê·¼ê±°:**
- `/ask`ëŠ” prompt-assistantê°€ ë¹ ë¥´ê²Œ ì‘ë‹µí•˜ë¯€ë¡œ resume í•„ìš”ì„± ë‚®ìŒ
- `/plan-draft`ëŠ” 5-10+ ë¼ìš´ë“œ Q&Aê°€ ì§„í–‰ë  ìˆ˜ ìˆì–´ resume í•„ìˆ˜

**ì‚¬ìš©ì ê²°ì •:** âœ… **ë‘˜ ë‹¤ ì ìš© + Native-Subagents í¬í•¨**

**ê²°ì • ì´ìœ  (ì‚¬ìš©ì ë°œì–¸):**
> "ë³µì¡í•œ ë¶„ì„ ì‹œ /askë„ ì¥ì‹œê°„ ì§„í–‰ë  ìˆ˜ ìˆìŒ. Native-Subagents(Explore, Plan, general-purpose, claude-code-guide)ë„ resume ì§€ì›"

**êµ¬í˜„ ìƒíƒœ:** â³ Plan íŒŒì¼ì— Agent ID ê¸°ë¡ ì „ëµ ë¬¸ì„œí™”ë¨

---

### ğŸ“‹ Round 3: `run_in_background=true` (2026-01-20 22:10)

**ê¸°ëŠ¥ ì„¤ëª…:**
Subagent ë°±ê·¸ë¼ìš´ë“œ ì‹¤í–‰ìœ¼ë¡œ ë³‘ë ¬ ì²˜ë¦¬ ê°€ëŠ¥ (Boris Cherny Pattern)

```python
# CORRECT: 3ê°œ ì´ìƒ ë…ë¦½ ì‘ì—… ë³‘ë ¬ ì‹¤í–‰
Task(subagent_type="Explore", prompt="...", run_in_background=True)
Task(subagent_type="Plan", prompt="...", run_in_background=True)
Task(subagent_type="general-purpose", prompt="...", run_in_background=True)
```

**í˜„ì¬ ìƒíƒœ:** `l1l2_inject.sh` (í˜„ì¬ `pre-task-inject.sh`) Hookì´ **ëª¨ë“  Task()ì— ìë™ ì£¼ì…** ì¤‘

**Claude ì¶”ì²œ:** Hook ì˜ì¡´ + ë¬¸ì„œí™”

**ì¶”ì²œ ê·¼ê±°:**
1. Hookì´ ì´ë¯¸ ìë™ ì²˜ë¦¬í•˜ë¯€ë¡œ ì½”ë“œ ì¤‘ë³µ ë¶ˆí•„ìš”
2. ì˜ë„ì  ë³‘ë ¬ ì‹¤í–‰(3+ Explore ë™ì‹œ)ì€ Skill ë¬¸ì„œì— ëª…ì‹œí•˜ë©´ ê°€ë…ì„± í–¥ìƒ
3. ì¤‘ì•™ ê´€ë¦¬(Hook) + ì˜ë„ ëª…ì‹œ(ë¬¸ì„œ) = ìµœì  ì¡°í•©

**ì‚¬ìš©ì ì§ˆë¬¸:** "ì˜ë„ì  ë³‘ë ¬ ì‹¤í–‰ì„ ëª…ì‹œí•  ìˆ˜ ìˆì–´? ì´ê²ƒì€ hooks, parameterì™€ ë‹¤ë¥¸ ê¸°ëŠ¥ ì„¹ì…˜ì¸ê°€?"

**Claude ì„¤ëª…:**
| ë ˆë²¨ | ëª©ì  | ì‹¤í–‰ ì˜í–¥ |
|------|------|----------|
| Hook | ì‹œìŠ¤í…œ ë ˆë²¨, ëª¨ë“  Task()ì— ìë™ ì ìš© | âœ… ê°•ì œ |
| Parameter | ê°œë³„ Task() í˜¸ì¶œ ì‹œ ì§€ì • | âœ… ëª…ì‹œì  |
| ë¬¸ì„œí™” | Skill íŒŒì¼ì— ê°€ì´ë“œë¼ì¸ìœ¼ë¡œ ì˜ë„ ëª…ì‹œ | âŒ ì—†ìŒ (ì°¸ê³ ìš©) |

**ì‚¬ìš©ì ê²°ì •:** âœ… **Hook ì˜ì¡´ + ë¬¸ì„œí™”**

**ê²°ì • ì´ìœ :** ì½”ë“œëŠ” Hookì— ë§¡ê¸°ê³ , Skill íŒŒì¼ì— ë³‘ë ¬ ì‹¤í–‰ ì˜ë„ë¥¼ ê°€ì´ë“œë¼ì¸ìœ¼ë¡œ ëª…ì‹œ

**êµ¬í˜„ ìƒíƒœ:** âœ… **IMPLEMENTED** - `pre-task-inject.sh`

---

### ğŸ“‹ Round 4: `context: fork` (2026-01-20 22:20)

**ê¸°ëŠ¥ ì„¤ëª…:**
Skillì´ ê²©ë¦¬ëœ ì»¨í…ìŠ¤íŠ¸ì—ì„œ ì‹¤í–‰. ë©”ì¸ ì»¨í…ìŠ¤íŠ¸ ì˜¤ì—¼ ë°©ì§€.

```yaml
# Skill YAML frontmatter
---
name: deep-analysis
context: fork  # ê²©ë¦¬ëœ ì»¨í…ìŠ¤íŠ¸
agent: general-purpose
---
```

**Claude ì¶”ì²œ:** /ask, /plan-draft: âŒ **ì‚¬ìš© ê¸ˆì§€**

**ì¶”ì²œ ê·¼ê±°:**
1. `context: fork`ëŠ” ê²©ë¦¬ëœ ì»¨í…ìŠ¤íŠ¸ì—ì„œ ì‹¤í–‰
2. AskUserQuestion ì‘ë‹µì´ ë©”ì¸ìœ¼ë¡œ ì „ë‹¬ ì•ˆ ë¨
3. /ask, /plan-draftëŠ” Socratic Q&Aê°€ í•µì‹¬ â†’ ì‚¬ìš©ì ì‘ë‹µ í•„ìˆ˜

**ì‚¬ìš©ì ì§ˆë¬¸ 1:** "AskUserQuestion ì‚¬ìš©ì— ëŒ€í•´ ë” ìì„¸íˆ ì„¤ëª…í•´"

**Claude ì„¤ëª…:**
| ëª¨ë“œ | User â†” Skill ìƒí˜¸ì‘ìš© | AskUserQuestion |
|------|----------------------|-----------------|
| standard | âœ… ê°€ëŠ¥ | âœ… ì‘ë™ |
| fork | âŒ ë¶ˆê°€ | âŒ ì‘ë‹µì´ Fork ë‚´ë¶€ì— ê°‡í˜ |

**ì‚¬ìš©ì ì§ˆë¬¸ 2:** "fork ì ìš©í•˜ë©´ Agents ìœ„ì„ í›„ì— ì–´ë–»ê²Œ ë˜ëŠ”ì§€ standardì™€ ë¹„êµí•´ë´"

**ìƒì„¸ ë¹„êµ:**
| í•­ëª© | standard | fork |
|------|----------|------|
| User â†” Skill ìƒí˜¸ì‘ìš© | âœ… ê°€ëŠ¥ | âŒ ë¶ˆê°€ |
| Skill ì¶œë ¥ì´ ë©”ì¸ì— ë³´ì„ | âš ï¸ ì˜ˆ (ì»¨í…ìŠ¤íŠ¸ ì˜¤ì—¼) | âŒ ê²©ë¦¬ |
| Skill â†” Agent ìƒí˜¸ì‘ìš© | âœ… ê°€ëŠ¥ | âœ… ê°€ëŠ¥ |
| ì í•©í•œ ìš©ë„ | Q&A, ëŒ€í™”í˜• | ë¶„ì„, ë°°ì¹˜ |

**ì‚¬ìš©ì ê²°ì •:** âœ… **/ask, /plan-draftëŠ” standard**

**ê²°ì • ì´ìœ :** ì‚¬ìš©ì Q&A í•„ìˆ˜. forkëŠ” /deep-audit ê°™ì€ ë¶„ì„ìš©ì—ë§Œ ì í•©

**êµ¬í˜„ ìƒíƒœ:** âœ… **Decided** - Skill YAMLì— ëª…ì‹œí•˜ì§€ ì•ŠìŒ (ê¸°ë³¸ê°’ standard ì‚¬ìš©)

---

### ğŸ“‹ Round 5: `model` Parameter (2026-01-21 14:50)

**ê¸°ëŠ¥ ì„¤ëª…:**
Task() í˜¸ì¶œ ì‹œ subagentì— ì‚¬ìš©í•  ëª¨ë¸ ì§€ì • (sonnet, opus, haiku)

```python
Task(subagent_type="Explore", prompt="...", model="opus")
```

**Claude ì¶”ì²œ:** âš ï¸ **ê¸°ë³¸ê°’ ìœ ì§€ (ìƒì†)**

**ì¶”ì²œ ê·¼ê±°:**
1. `/ask`, `/plan-draft`ëŠ” ì‚¬ìš©ìì™€ ì§ì ‘ ëŒ€í™”í•˜ëŠ” ìŠ¤í‚¬
2. ì‚¬ìš©ìê°€ ì„ íƒí•œ ëª¨ë¸(Opus 4.5) ì¡´ì¤‘í•˜ë©´ í’ˆì§ˆ ì¼ê´€ì„± ìœ ì§€
3. ëª¨ë¸ ì „í™˜ ì˜¤ë²„í—¤ë“œ ì—†ì´ ìì—°ìŠ¤ëŸ¬ìš´ ê²½í—˜

**ì‚¬ìš©ì ê²°ì •:** âœ… **Opus ëª…ì‹œ**

**ê²°ì • ì´ìœ  (ì‚¬ìš©ì ë°œì–¸):**
> "ìµœê³  í’ˆì§ˆ ë³´ì¥. /ask, /plan-draftëŠ” ì‚¬ìš©ìì™€ ì§ì ‘ ëŒ€í™”í•˜ë¯€ë¡œ í’ˆì§ˆì´ ì¤‘ìš”"

**êµ¬í˜„ ìƒíƒœ:** âœ… **Decided** â†’ Round 6ì—ì„œ Hookìœ¼ë¡œ êµ¬í˜„

---

### ğŸ“‹ Round 6: `updatedInput` Hook Response Field (2026-01-21 14:55)

**ê¸°ëŠ¥ ì„¤ëª…:**
PreToolUse Hookì—ì„œ ë„êµ¬ íŒŒë¼ë¯¸í„°ë¥¼ ê°•ì œ ë³€ê²½ (ì‹œìŠ¤í…œ ë ˆë²¨)

```bash
# Hook ì‘ë‹µ
{
  "hookSpecificOutput": {
    "permissionDecision": "allow",
    "updatedInput": {
      "run_in_background": true,
      "model": "opus"
    }
  }
}
```

**í˜„ì¬ ìƒíƒœ:** `l1l2_inject.sh`ê°€ ì´ë¯¸ `run_in_background=true` ìë™ ì£¼ì… ì¤‘

**Claude ì§ˆë¬¸:** Round 5ì—ì„œ Opus ëª…ì‹œ ê²°ì • â†’ Hookì— `model="opus"`ë„ ì¶”ê°€í• ì§€?

**ì˜µì…˜ ì œì‹œ:**
| ì˜µì…˜ | ì„¤ëª… |
|------|------|
| 1. Hookì— ì¶”ê°€ (ì¶”ì²œ) | ëª¨ë“  Task()ì— ìë™ ì£¼ì… |
| 2. Skillì—ë§Œ ëª…ì‹œ | Delegation Templateì— ì§ì ‘ ì‘ì„± |
| 3. ì„ íƒì  ì ìš© | prompt-assistantëŠ” Opus, ë‹¤ë¥¸ subagentëŠ” ìƒì† |

**ì‚¬ìš©ì ê²°ì •:** âœ… **Hookì— ì¶”ê°€ (ì¶”ì²œ)**

**ê²°ì • ì´ìœ :** ì¤‘ì•™ ê´€ë¦¬ë¡œ ì¼ê´€ì„± ë³´ì¥. ëª¨ë“  Task()ì— model="opus" ìë™ ì£¼ì…

**êµ¬í˜„ ì˜í–¥:**
- `pre-task-inject.sh` ìˆ˜ì • í•„ìš”
- `updatedInput`ì— `"model": "opus"` ì¶”ê°€

**êµ¬í˜„ ìƒíƒœ:** âœ… **IMPLEMENTED** - `pre-task-inject.sh:168`
```bash
UPDATED_INPUT=$(json_add_field "$UPDATED_INPUT" "model" '"opus"')
```

---

### ğŸ“‹ Round 7: `additionalContext` Hook Response Field (2026-01-21 15:05)

**ê¸°ëŠ¥ ì„¤ëª…:**
PreToolUse Hookì—ì„œ subagent í”„ë¡¬í”„íŠ¸ì— ì»¨í…ìŠ¤íŠ¸ ì£¼ì…

```bash
{
  "hookSpecificOutput": {
    "additionalContext": "## L1/L2 Output Format V2.3.0 (MANDATORY)..."
  }
}
```

**í˜„ì¬ ìƒíƒœ:** Hookì´ ëª¨ë“  Task()ì— L1/L2 í˜•ì‹ í”„ë¡¬í”„íŠ¸ ì£¼ì… ì¤‘

**ë¬¸ì œ ì œê¸°:**
- `/ask`: prompt-assistantëŠ” ëŒ€í™”í˜• Q&A â†’ L1/L2 í˜•ì‹ì´ ë¶€ìì—°ìŠ¤ëŸ¬ì›€
- `/plan-draft`: Socratic Q&A ì§„í–‰ â†’ ë§¤ í„´ YAML ì‘ë‹µì´ë©´ ì‚¬ìš©ì ê²½í—˜ ì €í•˜

**Claude ì„¤ëª… (ì‰¬ìš´ ë²„ì „):**
| ìœ í˜• | í•„ìš”í•œ ì‘ë‹µ | L1/L2 ì í•©ì„± |
|------|------------|-------------|
| ëŒ€í™”í˜• ìŠ¤í‚¬ | ìì—°ì–´ ì‘ë‹µ (ì¹œì ˆí•œ ëŒ€í™”) | âŒ ë¶€ì í•© |
| ë¶„ì„í˜• ìŠ¤í‚¬ | êµ¬ì¡°í™”ëœ ë³´ê³ ì„œ | âœ… ì í•© |

**ì˜µì…˜ ì œì‹œ:**
| ì˜µì…˜ | ì„¤ëª… |
|------|------|
| 1. ë¶„ê¸° ì²˜ë¦¬ (ì¶”ì²œ) | subagent_typeë³„ë¡œ L1/L2 ì ìš© ì—¬ë¶€ ê²°ì • |
| 2. ì „ì²´ ì ìš© | ëª¨ë“  ì‘ë‹µì´ ê¸°ê³„ì  í˜•ì‹ |
| 3. ì „ì²´ ì œì™¸ | ë¶„ì„ ê²°ê³¼ë„ êµ¬ì¡°í™” ì•ˆ ë¨ |

**ì‚¬ìš©ì ê²°ì •:** âœ… **ë¶„ê¸° ì²˜ë¦¬ (ì¶”ì²œ)**

**ê²°ì • ì´ìœ :** ëŒ€í™”í˜•(prompt-assistant)=ìì—°ì–´, ë¶„ì„í˜•(Explore/Plan)=L1/L2ë¡œ ë¶„ê¸°

**êµ¬í˜„ ì˜í–¥:**
- `pre-task-inject.sh` ìˆ˜ì • í•„ìš”
- `subagent_type` í™•ì¸ í›„ `additionalContext` ì¡°ê±´ë¶€ ì£¼ì…
- ì œì™¸ ëŒ€ìƒ: `prompt-assistant` (ëŒ€í™”í˜•)

**êµ¬í˜„ ìƒíƒœ:** âœ… **IMPLEMENTED** - `pre-task-inject.sh:101-181`
```bash
# Extract subagent_type for conditional L1/L2 injection (Round 7)
SUBAGENT_TYPE=$(json_get "$CURRENT_INPUT" ".subagent_type" "")
CONVERSATIONAL_AGENTS="prompt-assistant"

# Conversational agents: skip L1/L2 format injection (Round 7)
if [[ "$IS_CONVERSATIONAL" == "true" ]]; then
    # Return without additionalContext
fi
```

---

### ğŸ“‹ Round 8: Hook Events ê°œìš” (2026-01-21 15:10)

**ê¸°ëŠ¥ ì„¤ëª…:**
Claude Code Hook Events (10ê°œ ì´ë²¤íŠ¸ íƒ€ì…)

**í˜„ì¬ ì‚¬ìš© ì¤‘:**
- PreToolUse (l1l2_inject.sh â†’ pre-task-inject.sh)
- SessionStart (í™˜ì˜ ë©”ì‹œì§€)

**ì‚¬ìš©ì ìš”ì²­:** Hook Eventë„ í•˜ë‚˜ì”© ê²°ì •í•˜ê² ìŒ

**ì§„í–‰ ë°©ì‹:** Round 9~18ì—ì„œ ê° Hook Event ê°œë³„ ê²°ì •

---

### ğŸ“‹ Round 9: `PostToolUse` Hook (2026-01-21 15:15)

**ê¸°ëŠ¥ ì„¤ëª…:**
ë„êµ¬ ì‹¤í–‰ í›„ íŠ¸ë¦¬ê±°. ê²°ê³¼ ê°€ê³µ, ë¡œê¹…, í›„ì²˜ë¦¬ì— ì‚¬ìš©.

**L1/L2ì™€ì˜ ê´€ê³„:**
| Hook | ì‹œì  | ì—­í•  |
|------|------|------|
| PreToolUse | ì‹¤í–‰ ì „ | L1/L2 í˜•ì‹ ì£¼ì… |
| PostToolUse | ì‹¤í–‰ í›„ | ê²°ê³¼ ê´€ì°°/ê¸°ë¡ â†’ ì¶©ëŒ ì—†ìŒ |

**ì˜µì…˜ ì œì‹œ:**
| ì˜µì…˜ | ì„¤ëª… |
|------|------|
| 1. Agent ID ìº¡ì²˜ (ì¶”ì²œ) | resume ì§€ì› |
| 2. ê²°ê³¼ ë¡œê¹… | L1 ìš”ì•½ + Agent ID ê¸°ë¡ |
| 3. ë‘˜ ë‹¤ | Agent ID + ê²°ê³¼ ë¡œê¹… |
| 4. ì‚¬ìš© ì•ˆ í•¨ | - |

**ì‚¬ìš©ì ì§ˆë¬¸:** "ê²°ê³¼ ë¡œê¹…ì€ L1/L2 ì‹œìŠ¤í…œê³¼ ì–´ë– í•œ ìƒí˜¸ì‘ìš©ì´ ìˆê²Œ ë˜ë‚˜?"

**Claude ì„¤ëª…:**
- PostToolUseëŠ” ê²°ê³¼ë¥¼ **ê´€ì°°**í•˜ê³  **ê¸°ë¡**í•  ë¿
- L2 íŒŒì¼ ìƒì„±ê³¼ ì¤‘ë³µë˜ì§€ ì•ŠìŒ (L2ëŠ” subagentê°€ ìƒì„±)
- ë¡œê·¸ëŠ” ë³„ë„ íŒŒì¼ (`.agent/logs/task_execution.log`)

**ì‚¬ìš©ì ì¶”ê°€ ì§ˆë¬¸:** "Main Agentê°€ Auto-Compact ì´í›„ì—ë„ ì•Œ ìˆ˜ ìˆë‚˜?"

**Claude ì„¤ëª…:**
- âœ… **ì˜ˆ, ì•Œ ìˆ˜ ìˆìŒ**
- íŒŒì¼ ì‹œìŠ¤í…œì€ Auto-Compact ì˜í–¥ ë°›ì§€ ì•ŠìŒ
- ë¡œê·¸ íŒŒì¼ì—ì„œ Agent ID ì½ì–´ì„œ resume ê°€ëŠ¥

**ì‚¬ìš©ì ê²°ì •:** âœ… **ë‘˜ ë‹¤ (Agent ID ìº¡ì²˜ + ê²°ê³¼ ë¡œê¹…)**

**ê²°ì • ì´ìœ :** Auto-Compact í›„ì—ë„ Agent ID í™•ì¸ ê°€ëŠ¥. resume ì§€ì› ì™„ì „ ë³´ì¥.

**êµ¬í˜„ ì˜í–¥:**
- PostToolUse Hook ì‹ ê·œ ì‘ì„± í•„ìš”
- ë¡œê·¸ ê²½ë¡œ: `.agent/logs/task_execution.log`
- ê¸°ë¡ ë‚´ìš©: Agent ID, taskId, priority, status, findings_count, critical_count

**êµ¬í˜„ ìƒíƒœ:** âœ… **IMPLEMENTED** - `post-task-output.sh` V2.3.0

---

### ğŸ“‹ Round 10: `Stop` Hook (2026-01-21 15:20)

**ê¸°ëŠ¥ ì„¤ëª…:**
Main Agent ëŒ€í™” ì¢…ë£Œ ì‹œì ì— íŠ¸ë¦¬ê±°. ë§ˆì§€ë§‰ ì •ë¦¬ ì‘ì—….

**ì˜µì…˜ ì œì‹œ:**
| ì˜µì…˜ | ì„¤ëª… |
|------|------|
| 1. Draft ìƒíƒœ ì €ì¥ (ì¶”ì²œ) | /plan-draft ì¤‘ ì¢…ë£Œ ì‹œ í˜„ì¬ ìƒíƒœ ì˜êµ¬ ì €ì¥ |
| 2. ë¯¸ì™„ë£Œ ì•Œë¦¼ | ì¢…ë£Œ ì „ ì§„í–‰ ì¤‘ ì‘ì—… ì•ˆë‚´ |
| 3. ë‘˜ ë‹¤ | Draft ìƒíƒœ ì €ì¥ + ë¯¸ì™„ë£Œ ì•Œë¦¼ |
| 4. ì‚¬ìš© ì•ˆ í•¨ | - |

**ì‚¬ìš©ì ê²°ì •:** âœ… **ë‘˜ ë‹¤ (Draft ìƒíƒœ ì €ì¥ + ë¯¸ì™„ë£Œ ì•Œë¦¼)**

**ê²°ì • ì´ìœ :** ì„¸ì…˜ ì¢…ë£Œ ì‹œ ì‘ì—… ì†ì‹¤ ë°©ì§€. ì‚¬ìš©ìì—ê²Œ ë¯¸ì™„ë£Œ ì‘ì—… ì¸ì§€ì‹œí‚´.

**êµ¬í˜„ ì˜í–¥:**
- Stop Hook ì‹ ê·œ ì‘ì„± í•„ìš”
- Draft íŒŒì¼ ìƒíƒœë¥¼ `PAUSED`ë¡œ ë³€ê²½
- ì§„í–‰ ì¤‘ì¸ Task ëª©ë¡ ì¶œë ¥

**êµ¬í˜„ ìƒíƒœ:** â³ **Pending**

---

### ğŸ“‹ Round 11: `SubagentStop` Hook (2026-01-21 15:25)

**ê¸°ëŠ¥ ì„¤ëª…:**
Subagent ì‹¤í–‰ ì™„ë£Œ ì‹œì ì— íŠ¸ë¦¬ê±°. Subagent ë‚´ë¶€ì—ì„œ í˜¸ì¶œ.

**PostToolUseì™€ì˜ ê´€ê³„:**
| Hook | í˜¸ì¶œ ìœ„ì¹˜ | ì—­í•  |
|------|----------|------|
| PostToolUse | Main Agent | Task() ë°˜í™˜ í›„ (Agent ID ìº¡ì²˜) |
| SubagentStop | Subagent ë‚´ë¶€ | ì¢…ë£Œ ì‹œ (ë‚´ë¶€ ìƒíƒœ ê¸°ë¡) |

**ì˜µì…˜ ì œì‹œ:**
| ì˜µì…˜ | ì„¤ëª… |
|------|------|
| 1. ì‚¬ìš© ì•ˆ í•¨ (ì¶”ì²œ) | PostToolUseë¡œ ì¶©ë¶„. ì¤‘ë³µ ë°©ì§€ |
| 2. ì¢…ë£Œ ì‚¬ìœ  ê¸°ë¡ | subagent ì¢…ë£Œ ìƒì„¸ ì‚¬ìœ  (timeout, error, success) |

**ì‚¬ìš©ì ê²°ì •:** âœ… **ì¢…ë£Œ ì‚¬ìœ  ê¸°ë¡**

**ê²°ì • ì´ìœ :** PostToolUseì™€ ë³„ê°œë¡œ subagent ë‚´ë¶€ ì¢…ë£Œ ì‚¬ìœ (timeout, error, max_turns ë„ë‹¬ ë“±) ìƒì„¸ ê¸°ë¡

**êµ¬í˜„ ì˜í–¥:**
- SubagentStop Hook ì‹ ê·œ ì‘ì„± í•„ìš”
- ì¢…ë£Œ ì‚¬ìœ  ë¶„ë¥˜: success, timeout, error, max_turns_reached
- ë¡œê·¸ ê²½ë¡œ: `.agent/logs/subagent_stops.log`

**êµ¬í˜„ ìƒíƒœ:** â³ **Pending**

---

### ğŸ“‹ Round 12: `UserPromptSubmit` Hook (2026-01-21 15:30)

**ê¸°ëŠ¥ ì„¤ëª…:**
ì‚¬ìš©ìê°€ ë©”ì‹œì§€ë¥¼ ì…ë ¥í•œ ì§í›„ íŠ¸ë¦¬ê±°. Claude ì²˜ë¦¬ ì „.

**ì˜µì…˜ ì œì‹œ:**
| ì˜µì…˜ | ì„¤ëª… |
|------|------|
| 1. Q&A ë¡œê¹… (ì¶”ì²œ) | ì‚¬ìš©ì ì…ë ¥ì„ Draft íŒŒì¼ì— ìë™ ê¸°ë¡ |
| 2. ì…ë ¥ ì „ì²˜ë¦¬ | í‚¤ì›Œë“œ ê°ì§€, ì˜ë„ ë¶„ë¥˜ |
| 3. ë‘˜ ë‹¤ | Q&A ë¡œê¹… + ì…ë ¥ ì „ì²˜ë¦¬ |
| 4. ì‚¬ìš© ì•ˆ í•¨ | - |

**ì‚¬ìš©ì ê²°ì •:** âœ… **Q&A ë¡œê¹… (ì¶”ì²œ)**

**ê²°ì • ì´ìœ :** /plan-draft Q&A ê¸°ë¡ ìë™í™”. ì‚¬ìš©ì ì§ˆë¬¸/ì‘ë‹µ ì „ì²´ ì´ë ¥ ë³´ì¡´.

**êµ¬í˜„ ì˜í–¥:**
- UserPromptSubmit Hook ì‹ ê·œ ì‘ì„± í•„ìš”
- í™œì„± Draft íŒŒì¼ ê°ì§€ í›„ ì‚¬ìš©ì ì…ë ¥ ê¸°ë¡
- Q&A ë¡œê·¸ í˜•ì‹: `### User: {timestamp}\n{input}`

**êµ¬í˜„ ìƒíƒœ:** â³ **Pending**

---

### ğŸ“‹ Round 13: `PermissionRequest` Hook (2026-01-21 15:35)

**ê¸°ëŠ¥ ì„¤ëª…:**
Claudeê°€ ê¶Œí•œ ìš”ì²­í•  ë•Œ íŠ¸ë¦¬ê±°. ìë™ ìŠ¹ì¸/ê±°ë¶€ ì •ì±… ì ìš©.

**ì‚¬ìš©ì ì§ˆë¬¸:** "auto-compactì—ëŠ” ì‚¬ìš© ë¶ˆê°€ëŠ¥í•œê°€?"

**Claude ì„¤ëª…:**
| Hook | íŠ¸ë¦¬ê±° ì‹œì  | ìš©ë„ |
|------|------------|------|
| PermissionRequest | ë„êµ¬ ì‚¬ìš© ê¶Œí•œ ìš”ì²­ ì‹œ | ìë™ ìŠ¹ì¸/ê±°ë¶€ ì •ì±… |
| PreCompact | Auto-Compact ì§ì „ | ìƒíƒœ ì €ì¥ |

ë‘ Hookì€ ë³„ê°œ ì´ë²¤íŠ¸.

**ì˜µì…˜ ì œì‹œ:**
| ì˜µì…˜ | ì„¤ëª… |
|------|------|
| 1. ì‚¬ìš© ì•ˆ í•¨ (ì¶”ì²œ) | /ask, /plan-draftëŠ” ê¶Œí•œ ìš”ì²­ ê±°ì˜ ì—†ìŒ |
| 2. ë¡œê¹… ì „ìš© | ê¶Œí•œ ìš”ì²­ ê¸°ë¡ (ë””ë²„ê¹…ìš©) |

**ì‚¬ìš©ì ê²°ì •:** âœ… **ì‚¬ìš© ì•ˆ í•¨ (ì¶”ì²œ)**

**ê²°ì • ì´ìœ :** /ask, /plan-draftëŠ” ì½ê¸°/ë¶„ì„ ìœ„ì£¼. ê¶Œí•œ ìš”ì²­ ìƒí™© ê±°ì˜ ì—†ìŒ.

**êµ¬í˜„ ìƒíƒœ:** âŒ **Not Applicable**

---

### ğŸ“‹ Round 14: `Notification` Hook (2026-01-21 15:40)

**ê¸°ëŠ¥ ì„¤ëª…:**
ì‹œìŠ¤í…œ ì•Œë¦¼ ë°œìƒ ì‹œ íŠ¸ë¦¬ê±°. ì•Œë¦¼ í•„í„°ë§/ì»¤ìŠ¤í„°ë§ˆì´ì§•.

**ì˜µì…˜ ì œì‹œ:**
| ì˜µì…˜ | ì„¤ëª… |
|------|------|
| 1. ì‚¬ìš© ì•ˆ í•¨ (ì¶”ì²œ) | ê¸°ë³¸ ì•Œë¦¼ìœ¼ë¡œ ì¶©ë¶„ |
| 2. ì»¤ìŠ¤í„°ë§ˆì´ì§• | ì•Œë¦¼ í˜•ì‹/ë‚´ìš© ë³€ê²½ |

**ì‚¬ìš©ì ê²°ì •:** âœ… **ì‚¬ìš© ì•ˆ í•¨ (ì¶”ì²œ)**

**ê²°ì • ì´ìœ :** ê¸°ë³¸ ì•Œë¦¼ ì‹œìŠ¤í…œìœ¼ë¡œ ì¶©ë¶„. ì¶”ê°€ ì»¤ìŠ¤í„°ë§ˆì´ì§• ë¶ˆí•„ìš”.

**êµ¬í˜„ ìƒíƒœ:** âŒ **Not Applicable**

---

### ğŸ“‹ Round 15: `SessionStart` Hook (2026-01-21 15:45)

**ê¸°ëŠ¥ ì„¤ëª…:**
ì„¸ì…˜ ì‹œì‘ ì‹œ íŠ¸ë¦¬ê±°. í™˜ì˜ ë©”ì‹œì§€, ì´ˆê¸°í™”.

**í˜„ì¬ ìƒíƒœ:** ì´ë¯¸ ì‚¬ìš© ì¤‘ (í™˜ì˜ ë©”ì‹œì§€ í‘œì‹œ)

**ì‚¬ìš©ì ì§ˆë¬¸:** "auto-compact ì´í›„ë„ ìƒˆë¡œìš´ ì„¸ì…˜ìœ¼ë¡œ íŒë‹¨ë˜ë‚˜?"

**Claude ì„¤ëª…:**
| ì´ë²¤íŠ¸ | SessionStart í˜¸ì¶œ |
|--------|------------------|
| Claude Code ì‹œì‘ | âœ… ì˜ˆ (ìƒˆ ì„¸ì…˜) |
| Auto-Compact | âŒ ì•„ë‹ˆì˜¤ (ê°™ì€ ì„¸ì…˜ ë‚´ ë©”ëª¨ë¦¬ ì •ë¦¬) |

**ì˜µì…˜ ì œì‹œ:**
| ì˜µì…˜ | ì„¤ëª… |
|------|------|
| 1. Draft ë³µêµ¬ ì•Œë¦¼ (ì¶”ì²œ) | ìƒˆ ì„¸ì…˜ ì‹œì‘ ì‹œ ë¯¸ì™„ë£Œ Draft ìˆìœ¼ë©´ ì•Œë¦¼ |
| 2. í˜„ìƒ ìœ ì§€ | ê¸°ì¡´ í™˜ì˜ ë©”ì‹œì§€ë§Œ |

**ì‚¬ìš©ì ê²°ì •:** âœ… **Draft ë³µêµ¬ ì•Œë¦¼ (ì¶”ì²œ)**

**ê²°ì • ì´ìœ :** ìƒˆ ì„¸ì…˜ ì‹œì‘ ì‹œ ì´ì „ ë¯¸ì™„ë£Œ /plan-draft ì‘ì—… ì•Œë¦¼. ì‘ì—… ì—°ì†ì„± ë³´ì¥.

**êµ¬í˜„ ì˜í–¥:**
- SessionStart Hook ìˆ˜ì • í•„ìš”
- `.agent/plans/` ë””ë ‰í† ë¦¬ ìŠ¤ìº”í•˜ì—¬ ìƒíƒœê°€ `in_progress` ë˜ëŠ” `PAUSED`ì¸ íŒŒì¼ ê²€ìƒ‰
- ë°œê²¬ ì‹œ ì•Œë¦¼: "ë¯¸ì™„ë£Œ Draft ë°œê²¬: {filename}. `/resume`ë¡œ ê³„ì†í•˜ì„¸ìš”."

**êµ¬í˜„ ìƒíƒœ:** â³ **Pending**

---

### ğŸ“‹ Round 16: `SessionEnd` Hook (2026-01-21 15:50)

**ê¸°ëŠ¥ ì„¤ëª…:**
ì„¸ì…˜ ì¢…ë£Œ ì‹œ íŠ¸ë¦¬ê±°. ìµœì¢… ì •ë¦¬ ì‘ì—….

**Stop Hookê³¼ì˜ ê´€ê³„:**
| Hook | íŠ¸ë¦¬ê±° ì‹œì  |
|------|------------|
| Stop | ì‚¬ìš©ìê°€ ì¢…ë£Œ ëª…ë ¹ ì‹œ (ëŒ€í™” ì¢…ë£Œ) |
| SessionEnd | ì‹œìŠ¤í…œì´ ì„¸ì…˜ ì¢…ë£Œ ê°ì§€ (ì™„ì „ ì¢…ë£Œ) |

**ì˜µì…˜ ì œì‹œ:**
| ì˜µì…˜ | ì„¤ëª… |
|------|------|
| 1. ì‚¬ìš© ì•ˆ í•¨ (ì¶”ì²œ) | Stop Hookìœ¼ë¡œ ì¶©ë¶„. ì¤‘ë³µ ë°©ì§€ |
| 2. ìµœì¢… ë¡œê·¸ ê¸°ë¡ | ì„¸ì…˜ í†µê³„ ê¸°ë¡ |

**ì‚¬ìš©ì ê²°ì •:** âœ… **ì‚¬ìš© ì•ˆ í•¨ (ì¶”ì²œ)**

**ê²°ì • ì´ìœ :** Stop Hookì—ì„œ ì´ë¯¸ Draft ìƒíƒœ ì €ì¥ ì²˜ë¦¬. SessionEndëŠ” ì¤‘ë³µ.

**êµ¬í˜„ ìƒíƒœ:** âŒ **Not Applicable**

---

### ğŸ“‹ Round 17: `PreCompact` Hook (2026-01-21 15:55)

**ê¸°ëŠ¥ ì„¤ëª…:**
Auto-Compact ì§ì „ì— íŠ¸ë¦¬ê±°. ë§ˆì§€ë§‰ ìƒíƒœ ì €ì¥ ê¸°íšŒ.

**ì¤‘ìš”ì„±:** âš ï¸ **resume ì§€ì›ì˜ í•µì‹¬**. Auto-Compact í›„ ë©”ëª¨ë¦¬ ì‚¬ë¼ì§€ë¯€ë¡œ íŒŒì¼ ì €ì¥ í•„ìˆ˜.

**ì‚¬ìš©ì ì§ˆë¬¸:** "ì´ê²ƒ ê´€ë ¨í•œ ì‹œìŠ¤í…œ íŒŒë¼ë¯¸í„° ì—†ë‚˜?"

**Claude ì„¤ëª…:**
- ì‹œìŠ¤í…œ íŒŒë¼ë¯¸í„°ë¡œ ìë™ ì €ì¥ë˜ëŠ” ê²ƒì€ ì—†ìŒ
- PreCompact Hookì—ì„œ ì§ì ‘ íŒŒì¼ë¡œ ì €ì¥í•´ì•¼ í•¨
- Hook ì…ë ¥ì— context_usage (í† í° ì‚¬ìš©ëŸ‰) ì •ë³´ í¬í•¨

**ì˜µì…˜ ì œì‹œ:**
| ì˜µì…˜ | ì„¤ëª… |
|------|------|
| 1. ì „ì²´ ìƒíƒœ ì €ì¥ (ê°•ë ¥ ì¶”ì²œ) | Agent ID + Draft ìƒíƒœ + ë¼ìš´ë“œ ë²ˆí˜¸ |
| 2. Agent IDë§Œ ì €ì¥ | resumeë§Œ ì§€ì› |
| 3. ì‚¬ìš© ì•ˆ í•¨ | Auto-Compact í›„ ìƒíƒœ ì†ì‹¤ ìœ„í—˜ |

**ì‚¬ìš©ì ê²°ì •:** âœ… **ì „ì²´ ìƒíƒœ ì €ì¥ (ê°•ë ¥ ì¶”ì²œ)**

**ê²°ì • ì´ìœ :** Auto-Compact í›„ì—ë„ ì™„ì „í•œ ìƒíƒœ ë³µêµ¬ ê°€ëŠ¥. resume + Q&A ì—°ì†ì„± ëª¨ë‘ ì§€ì›.

**êµ¬í˜„ ì˜í–¥:**
- PreCompact Hook ì‹ ê·œ ì‘ì„± í•„ìš”
- Draft íŒŒì¼ ë©”íƒ€ë°ì´í„° ì—…ë°ì´íŠ¸:
  - `last_agent_ids: [a1b2c3d, e5f6g7h]`
  - `qa_round: 17`
  - `status: COMPACTING`
- `.agent/logs/precompact.log`ì— ì»¨í…ìŠ¤íŠ¸ ìŠ¤ëƒ…ìƒ· ê¸°ë¡

**êµ¬í˜„ ìƒíƒœ:** â³ **Pending**

---

### ğŸ“‹ Round 18: `allowed-tools` Skill Frontmatter (2026-01-21 16:00)

**ê¸°ëŠ¥ ì„¤ëª…:**
Skillì´ ì‚¬ìš©í•  ìˆ˜ ìˆëŠ” ë„êµ¬ ëª©ë¡ ì œí•œ. ìµœì†Œ ê¶Œí•œ ì›ì¹™.

**í˜„ì¬ ìƒíƒœ:**
- /ask: `Read, Grep, Glob, AskUserQuestion, Task, WebSearch`
- /plan-draft: (ëª…ì‹œ ì•ˆ ë¨)

**ì˜µì…˜ ì œì‹œ:**
| ì˜µì…˜ | ì„¤ëª… |
|------|------|
| 1. ì¶”ì²œëŒ€ë¡œ (ìµœì†Œ ê¶Œí•œ) | /ask ìœ ì§€, /plan-draft + Write ì¶”ê°€ |
| 2. ë„˜ë„˜í•˜ê²Œ (ì „ì²´ í—ˆìš©) | ëª¨ë“  ë„êµ¬ í—ˆìš© |
| 3. ì—„ê²©í•˜ê²Œ (ì½ê¸° ì „ìš©) | Task ì œì™¸ |

**ì‚¬ìš©ì ê²°ì •:** âœ… **ë„˜ë„˜í•˜ê²Œ (ì „ì²´ í—ˆìš©)**

**ê²°ì • ì´ìœ  (ì‚¬ìš©ì ë°œì–¸):**
> "ìœ ì—°ì„± ìš°ì„ . í•„ìš”í•œ ë„êµ¬ ì œí•œ ì—†ì´ ëª¨ë“  ê¸°ëŠ¥ ì‚¬ìš© ê°€ëŠ¥."

**êµ¬í˜„ ì˜í–¥:**
- /ask: `allowed-tools` ì œê±° ë˜ëŠ” `*` (ì „ì²´)
- /plan-draft: `allowed-tools` ì œê±° ë˜ëŠ” `*` (ì „ì²´)

**êµ¬í˜„ ìƒíƒœ:** âœ… **Decided** - Skill íŒŒì¼ ìˆ˜ì • ì‹œ ì ìš©

---

### ğŸ“‹ Round 19: Progressive Disclosure (2026-01-21 16:05)

**ê¸°ëŠ¥ ì„¤ëª…:**
ë¬¸ì„œë¥¼ ê³„ì¸µì ìœ¼ë¡œ ë¶„ë¦¬í•˜ëŠ” íŒ¨í„´ (Layer 1/2/3)

**ì‚¬ìš©ì ìš”ì²­:** "L1/L2 ì „ì²´ì‹œìŠ¤í…œ ëŒ€ê·œëª¨ê°œì„ ì„ ì´ê²ƒì„ ì ìš©í•´ì„œ í•  ìˆ˜ ìˆëŠ” ë°©ë²• ì—°êµ¬í•´ë´"

**Claude ì—°êµ¬ ê²°ê³¼:**

**3-Layer L1/L2 ì‹œìŠ¤í…œ ì œì•ˆ:**
| Layer | ë‚´ìš© | í† í° | ì „ë‹¬ ë°©ì‹ |
|-------|------|------|----------|
| Layer 1 | L1 Summary | ~300 | í•­ìƒ ë°˜í™˜ |
| Layer 2 | L2 Index (ëª©ì°¨ + ìš°ì„ ìˆœìœ„) | ~200 | í•­ìƒ ë°˜í™˜ |
| Layer 3 | L2 Detail | ê°€ë³€ | ìš”ì²­ ì‹œë§Œ Read() |

**ê°œì„  í¬ì¸íŠ¸:**
1. L1ì— `priority` (CRITICAL/HIGH/MEDIUM/LOW) ì¶”ê°€
2. L1ì— `recommendedRead` (ì¶”ì²œ ì½ê¸° ìˆœì„œ + ì´ìœ ) ì¶”ê°€
3. `l2Index[].tokens` - ì„¹ì…˜ë³„ í† í° ì¶”ì •ì¹˜
4. `l2Index[].priority` - ì„¹ì…˜ë³„ ìš°ì„ ìˆœìœ„

**ì¥ì :**
- ì»¨í…ìŠ¤íŠ¸ íš¨ìœ¨: í•„ìš”í•œ ì„¹ì…˜ë§Œ ì½ì–´ì„œ í† í° ì ˆì•½
- í™•ì¥ì„±: 50ê°œ, 100ê°œ íŒŒì¼ë„ ì²˜ë¦¬ ê°€ëŠ¥
- Auto-Compact ë°©ì§€: ë¶ˆí•„ìš”í•œ ìƒì„¸ ë‚´ìš© ë¡œë“œ ì•ˆ í•¨

**ì‚¬ìš©ì ê²°ì •:** âœ… **í†µí•© ì ìš© + Plan Agentë¡œ ë¬¸ì„œí™” + ì½”ë“œ ë ˆë²¨ê¹Œì§€ ì‘ì„±**

**ê²°ì • ì´ìœ :** L1/L2 ì‹œìŠ¤í…œì˜ ëŒ€ê·œëª¨ ê°œì„ . Progressive Disclosure ì›ì¹™ìœ¼ë¡œ ì»¨í…ìŠ¤íŠ¸ íš¨ìœ¨ ê·¹ëŒ€í™”.

**êµ¬í˜„ ê²°ê³¼:**
- Plan íŒŒì¼ ìƒì„±: `.agent/plans/progressive_disclosure_l1l2_v2.3.md`
- Hook ìˆ˜ì •: `pre-task-inject.sh` V2.3.0
- Hook ìˆ˜ì •: `post-task-output.sh` V2.3.0
- ë¬¸ì„œ ìˆ˜ì •: `CLAUDE.md` Section 2.7

**êµ¬í˜„ ìƒíƒœ:** âœ… **IMPLEMENTED**

---

### ğŸ“‹ Round 20: `max_turns` Parameter (2026-01-21 16:45)

**ê¸°ëŠ¥ ì„¤ëª…:**
Subagentê°€ ì‹¤í–‰í•  ìµœëŒ€ API ë¼ìš´ë“œíŠ¸ë¦½ ìˆ˜ ì œí•œ. ë¬´í•œ ë£¨í”„ ë°©ì§€ ë° ë¦¬ì†ŒìŠ¤ ê´€ë¦¬.

```python
Task(
    subagent_type="Explore",
    prompt="...",
    max_turns=8  # ìµœëŒ€ 8í„´ í›„ ì¤‘ë‹¨
)
```

**Claude ì¶”ì²œ:**
| Subagent Type | ì¶”ì²œ max_turns | ê·¼ê±° |
|---------------|---------------|------|
| Explore | 8 | íŒŒì¼ íƒìƒ‰ì€ ë³´í†µ 5-8í„´ ë‚´ ì™„ë£Œ |
| Plan | 12 | ì„¤ê³„ ì‘ì—…ì€ ë” ë§ì€ ë°˜ë³µ í•„ìš” |
| general-purpose | 15 | ë³µì¡í•œ ì‘ì—…, êµ¬í˜„ í¬í•¨ ì‹œ ì¶©ë¶„í•œ ì—¬ìœ  |
| prompt-assistant | 5 | ëŒ€í™”í˜•, ë¹ ë¥¸ ì‘ë‹µ ëª©ì  |
| claude-code-guide | 10 | ë¬¸ì„œ ê²€ìƒ‰ + ìš”ì•½ |

**ì¶”ì²œ ê·¼ê±°:**
1. **Explore**: íŒŒì¼ íƒìƒ‰ì€ Glob/Grep/Read ì¡°í•©ìœ¼ë¡œ ë¹ ë¥´ê²Œ ì™„ë£Œ. 8í„´ ë„˜ì–´ê°€ë©´ ë¹„íš¨ìœ¨ì  ìˆœí™˜
2. **Plan**: ì„¤ê³„ëŠ” ì—¬ëŸ¬ íŒŒì¼ ê²€í†  â†’ êµ¬ì¡° ì„¤ê³„ â†’ ê²€ì¦ í•„ìš”
3. **general-purpose**: ì‹¤ì œ êµ¬í˜„ í¬í•¨ ì‹œ Edit/Write/Bash ë°˜ë³µ
4. **prompt-assistant**: Q&AëŠ” 2-3í„´ ë‚´ í•´ê²°ë˜ì–´ì•¼ í•¨
5. **claude-code-guide**: ë¬¸ì„œ ê²€ìƒ‰ í›„ ìš”ì•½

**ì‚¬ìš©ì ì§ˆë¬¸ 1:** ì ìš© ë°©ì‹ì„ ì–´ë–»ê²Œ í• ê¹Œìš”?

**ì˜µì…˜ ì œì‹œ:**
| ì˜µì…˜ | ì„¤ëª… |
|------|------|
| 1. Hookì— ìë™ ì£¼ì… (ì¶”ì²œ) | subagent_typeë³„ë¡œ Hookì—ì„œ ìë™ ì„¤ì • |
| 2. Skillì—ë§Œ ëª…ì‹œ | ê° Skill íŒŒì¼ì˜ Delegation Templateì— ì§ì ‘ ì‘ì„± |
| 3. ì „ì²´ í†µì¼ ê°’ | ëª¨ë“  subagentì— ë™ì¼í•œ ê°’ ì ìš© |
| 4. ì‚¬ìš© ì•ˆ í•¨ | max_turns ì„¤ì •í•˜ì§€ ì•ŠìŒ (ê¸°ë³¸ê°’ ìœ ì§€) |

**ì‚¬ìš©ì ê²°ì •:** âœ… **Hookì— ìë™ ì£¼ì… (ì¶”ì²œ)**

**ì‚¬ìš©ì ì§ˆë¬¸ 2:** ì¶”ì²œ ê°’ë“¤ì´ ì ì ˆí•œê°€ìš”?

**ì‚¬ìš©ì ê²°ì •:** âœ… **ì¶”ì²œëŒ€ë¡œ** (Explore:8, Plan:12, general-purpose:15, prompt-assistant:5, claude-code-guide:10)

**ê²°ì • ì´ìœ :** ì¤‘ì•™ ê´€ë¦¬(Hook)ë¡œ ì¼ê´€ì„± ë³´ì¥. subagent_typeë³„ ìµœì í™”ëœ í„´ ì œí•œìœ¼ë¡œ ë¦¬ì†ŒìŠ¤ íš¨ìœ¨í™”.

**êµ¬í˜„ ì˜í–¥:**
- `pre-task-inject.sh` ìˆ˜ì • í•„ìš”
- subagent_type í™•ì¸ í›„ max_turns ìë™ ì£¼ì…

**êµ¬í˜„ ìƒíƒœ:** â³ **Pending Implementation**

---

### ğŸ“‹ Round 21: `description` Pattern (2026-01-21 16:50)

**ê¸°ëŠ¥ ì„¤ëª…:**
Task() í˜¸ì¶œ ì‹œ subagent ì‘ì—…ì— ëŒ€í•œ ì§§ì€ ì„¤ëª… (3-5 words).

```python
Task(
    subagent_type="Explore",
    prompt="...",
    description="Analyze auth module"  # 3-5 words, English only
)
```

**descriptionì˜ ì—­í• :**
| ìš©ë„ | ì„¤ëª… |
|------|------|
| ë¡œê·¸ ê°€ì‹œì„± | `.agent/logs/task_execution.log`ì— ê¸°ë¡ë¨ |
| ë””ë²„ê¹… | ì–´ë–¤ Taskê°€ ì‹¤í–‰ ì¤‘ì¸ì§€ ë¹ ë¥´ê²Œ íŒŒì•… |
| TodoWrite ì—°ë™ | `activeForm`ê³¼ ìœ ì‚¬í•˜ê²Œ ì§„í–‰ ìƒí™© í‘œì‹œ |
| ì‚¬ìš©ì ì•Œë¦¼ | Background ì‘ì—… ì™„ë£Œ ì‹œ ì•Œë¦¼ ë©”ì‹œì§€ì— í‘œì‹œ |

**Claude ì¶”ì²œ: í‘œì¤€ íŒ¨í„´ ì •ì˜**

| Subagent Type | Description íŒ¨í„´ | ì˜ˆì‹œ |
|---------------|------------------|------|
| Explore | `{Action} {Target}` | "Analyze codebase structure", "Find auth files" |
| Plan | `{Phase} {Feature}` | "Design auth module", "Plan API refactor" |
| general-purpose | `{Action} {Scope}` | "Implement login flow", "Fix validation bug" |
| prompt-assistant | `{Intent} for user` | "Clarify requirements", "Answer user question" |
| claude-code-guide | `{Query} documentation` | "Search hook docs", "Find MCP reference" |

**ì¶”ì²œ ê·¼ê±°:**
1. **ê°€ë…ì„±**: ì§§ê³  ëª…í™•í•œ íŒ¨í„´ìœ¼ë¡œ ë¡œê·¸ ê°€ë…ì„± í–¥ìƒ
2. **ì¼ê´€ì„±**: ëª¨ë“  Task()ê°€ ë™ì¼í•œ í˜•ì‹ â†’ ë””ë²„ê¹… ìš©ì´
3. **ìë™ ìƒì„± ë¶ˆê°€**: promptì—ì„œ ìë™ ì¶”ì¶œì€ ë¶€ì •í™•. ëª…ì‹œì  ì‘ì„± ê¶Œì¥

**ì‚¬ìš©ì ì§ˆë¬¸:** description ê´€ë¦¬ ë°©ì‹ì„ ì–´ë–»ê²Œ í• ê¹Œìš”?

**ì˜µì…˜ ì œì‹œ:**
| ì˜µì…˜ | ì„¤ëª… |
|------|------|
| 1. í‘œì¤€ íŒ¨í„´ ì •ì˜ (ì¶”ì²œ) | ë¬¸ì„œì— ê°€ì´ë“œë¼ì¸ ì •ì˜, Skill ì‘ì„± ì‹œ ì¤€ìˆ˜ |
| 2. Hook ìë™ ìƒì„± | description ì—†ìœ¼ë©´ prompt ì²« 30ì ìë™ ì„¤ì • |
| 3. í‘œì¤€ íŒ¨í„´ + Hook í´ë°± | íŒ¨í„´ ì •ì˜ + ë¹„ì–´ìˆìœ¼ë©´ ìë™ ìƒì„± |
| 4. í˜„ìƒ ìœ ì§€ | ë³„ë„ ê·œì¹™ ì—†ì´ ììœ ë¡­ê²Œ |

**ì‚¬ìš©ì ì¶”ê°€ ì§€ì‹œ:** "descriptionì— ëŒ€í•´ ë” ìì„¸íˆ ì„¤ëª…í•´ë´"

**Claude ìƒì„¸ ì„¤ëª… ì œê³µ** (description ì—­í• , í˜„ì¬ ì‚¬ìš© ì˜ˆì‹œ, ì˜µì…˜ë³„ ì¥ë‹¨ì , Hook ìë™ ìƒì„± ë°©ì‹ ì˜ˆì‹œ í¬í•¨)

**ì‚¬ìš©ì ì¶”ê°€ ì§€ì‹œ:** "ëª¨ë“  ì„¸ì…˜ ëª¨ë“  ì‘ì—…ì— í•­ìƒ ì˜ì–´(ì›ì–´) ì‚¬ìš©"

**ì‚¬ìš©ì ê²°ì •:** âœ… **í‘œì¤€ íŒ¨í„´ ì •ì˜ (ì¶”ì²œ)** + **English Only Rule**

**ê²°ì • ì´ìœ :** ì¼ê´€ëœ íŒ¨í„´ìœ¼ë¡œ ë¡œê·¸ ê°€ë…ì„± ë³´ì¥. ì˜ì–´ë§Œ ì‚¬ìš©í•˜ì—¬ ì‹œìŠ¤í…œ í˜¸í™˜ì„± ìœ ì§€.

**êµ¬í˜„ ì˜í–¥:**
- Description íŒ¨í„´ ê°€ì´ë“œë¼ì¸ ë¬¸ì„œí™” í•„ìš”
- ê¸°ì¡´ Skillsì˜ description ê²€í†  ë° ìˆ˜ì •

**êµ¬í˜„ ìƒíƒœ:** â³ **Pending Documentation**

**Description Pattern Guidelines (English Only):**
```markdown
## Description Writing Guide

### Format: `{Verb} {Target}` (3-5 words, English only)

### Examples by Subagent Type:
- Explore: "Analyze {target}", "Find {pattern}", "Map {structure}"
- Plan: "Design {feature}", "Plan {approach}", "Draft {document}"
- general-purpose: "Implement {feature}", "Fix {bug}", "Refactor {code}"
- prompt-assistant: "Clarify {topic}", "Answer {question}"
- claude-code-guide: "Search {docs}", "Find {reference}"

### Rules:
- Maximum 5 words
- English only (no Korean/other languages)
- Start with action verb
- No file paths (paths go in prompt)
- No punctuation at end
```

---

## DETAIL: Native Capabilities Reference {#native-ref}

### 1. resume Parameter
```python
# ì²« ì‹¤í–‰ ì‹œ agent_id ë°˜í™˜ë¨
result = Task(
    subagent_type="Explore",
    prompt="...",
    run_in_background=True
)
# â†’ agent_id: "a1b2c3d"

# Auto-Compact í›„ ì¬ê°œ
Task(
    subagent_type="Explore",
    prompt="Continue analysis",
    resume="a1b2c3d",  # ì´ì „ agent ID
    run_in_background=True
)
```

### 2. run_in_background + Parallel Deployment
```python
# Boris Cherny Pattern: 3+ ë…ë¦½ ì‘ì—… ë³‘ë ¬ ì‹¤í–‰
Task(subagent_type="Explore", prompt="...", run_in_background=True)
Task(subagent_type="Plan", prompt="...", run_in_background=True)
Task(subagent_type="general-purpose", prompt="...", run_in_background=True)
# ëª¨ë‘ ë™ì‹œ ì‹¤í–‰, ê²°ê³¼ëŠ” ë‚˜ì¤‘ì— ìˆ˜ì§‘
```

### 3. context: fork (Skill YAML)
```yaml
---
name: deep-analysis
context: fork  # ê²©ë¦¬ëœ ì»¨í…ìŠ¤íŠ¸ì—ì„œ ì‹¤í–‰
agent: general-purpose
---
```

### 4. updatedInput + additionalContext (Hook V2.1.9+)
```bash
# PreToolUse Hook ì‘ë‹µ
{
  "hookSpecificOutput": {
    "permissionDecision": "allow",
    "updatedInput": {
      "run_in_background": true,
      "model": "opus"
    },
    "additionalContext": "L1/L2 format required..."
  }
}
```

### 5. allowed-tools (ìµœì†Œ ê¶Œí•œ)
```yaml
# Read-only analysis
allowed-tools: Read, Grep, Glob

# With execution
allowed-tools: Read, Grep, Glob, Bash

# Full modification
allowed-tools: Read, Grep, Glob, Bash, Edit, Write

# ì „ì²´ í—ˆìš© (Round 18 ê²°ì •)
# allowed-tools ìƒëµ ë˜ëŠ” * ì‚¬ìš©
```

---

## DETAIL: íŒŒì¼ë³„ í˜„í™© ë¶„ì„ {#file-analysis}

### /ask (Command + Skill)
**í˜„ì¬ ìƒíƒœ:**
- Delegation Templateì—ì„œ `context="fork"` ì–¸ê¸‰ë§Œ
- `run_in_background` ë¯¸ì ìš© â†’ Hookì´ ìë™ ì²˜ë¦¬
- `resume` ë¯¸ì ìš©

**ê°œì„  í¬ì¸íŠ¸:**
- [x] Hookìœ¼ë¡œ `run_in_background=true` ìë™ ì£¼ì…
- [x] Hookìœ¼ë¡œ `model="opus"` ìë™ ì£¼ì…
- [ ] ì¥ì‹œê°„ ë¶„ì„ ì‹œ `resume` ì§€ì› (Plan íŒŒì¼ ì°¸ì¡°)

### /plan-draft (Command + Skill)
**í˜„ì¬ ìƒíƒœ:**
- Socratic Q&A ë£¨í”„ êµ¬í˜„
- Phase 3: Explorationì—ì„œ Task() ì‚¬ìš©
- Background ì‹¤í–‰ ë¯¸ì ìš© â†’ Hookì´ ìë™ ì²˜ë¦¬

**ê°œì„  í¬ì¸íŠ¸:**
- [x] Hookìœ¼ë¡œ `run_in_background=true` ìë™ ì£¼ì…
- [x] Hookìœ¼ë¡œ `model="opus"` ìë™ ì£¼ì…
- [ ] Agent ID ì €ì¥í•˜ì—¬ `resume` ì§€ì›
- [ ] Prompt-based Stop hook ì¶”ê°€

### /commit-push-pr (Command only)
**í˜„ì¬ ìƒíƒœ:**
- Pre-flight checks êµ¬í˜„
- Governance í†µí•© ì–¸ê¸‰ë§Œ

**ê°œì„  í¬ì¸íŠ¸:**
- [x] Hookìœ¼ë¡œ `run_in_background=true` ìë™ ì£¼ì…
- [ ] Push ì‹¤íŒ¨ ì‹œ `resume` ì§€ì›

### /teleport (Command only)
**í˜„ì¬ ìƒíƒœ:**
- Web â†” CLI ì„¸ì…˜ ì „ì†¡
- Python ìŠ¤í¬ë¦½íŠ¸ ì˜ì¡´

**ê°œì„  í¬ì¸íŠ¸:**
- [x] Hookìœ¼ë¡œ `run_in_background=true` ìë™ ì£¼ì…
- (ìš°ì„ ìˆœìœ„ ë‚®ìŒ - ì´ë¯¸ ì˜ ë™ì‘)

### /docx-automation (Skill only)
**í˜„ì¬ ìƒíƒœ:**
- Pipeline í†µí•© ì™„ë£Œ
- python-docx ì˜ì¡´

**ê°œì„  í¬ì¸íŠ¸:**
- [x] Hookìœ¼ë¡œ `run_in_background=true` ìë™ ì£¼ì…
- (ìš°ì„ ìˆœìœ„ ë‚®ìŒ - íŠ¹ìˆ˜ ëª©ì )

---

## DETAIL: ë¦¬ìŠ¤í¬ ë¶„ì„ {#risk-analysis}

| ë¦¬ìŠ¤í¬ | ì˜í–¥ | ì™„í™” ë°©ì•ˆ | ìƒíƒœ |
|--------|------|----------|------|
| Commands/Skills ì¤‘ë³µ | LOW | í†µí•© ë˜ëŠ” ì—­í•  ëª…í™•í™” | â³ ëª¨ë‹ˆí„°ë§ |
| context:fork ì œí•œì‚¬í•­ | MEDIUM | User interaction í•„ìš” ì‹œ standard ì‚¬ìš© | âœ… í•´ê²° (Round 4) |
| resume ID ê´€ë¦¬ ë³µì¡ë„ | LOW | Plan íŒŒì¼ì— ìë™ ê¸°ë¡ | â³ êµ¬í˜„ ì˜ˆì • |
| ë³‘ë ¬ ì‹¤í–‰ ìˆœì„œ ë¬¸ì œ | LOW | ë…ë¦½ ì‘ì—…ë§Œ ë³‘ë ¬í™” | âœ… í•´ê²° (Round 3) |
| L1/L2 í˜•ì‹ ê²½ì§ì„± | MEDIUM | subagent_typeë³„ ë¶„ê¸° ì²˜ë¦¬ | âœ… í•´ê²° (Round 7) |

---

## Metadata

- Created: 2026-01-20 21:35
- Last Updated: 2026-01-21 16:55
- Q&A Rounds: 21 (completed)
- State: âœ… ROUND 1-19 IMPLEMENTED, âœ… ROUND 20-21 DECIDED (Pending Implementation)
