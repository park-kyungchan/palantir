# Draft: /create Command - Unified System Component Builder

> **Version:** 1.0.0 | **Status:** IN_PROGRESS | **Date:** 2026-01-21
> **Auto-Compact Safe:** This file persists across context compaction
> **Plan Agent Optimized:** INDEX → DETAIL progressive structure

---

## INDEX

### 요구사항 요약
Agent, Skill, Hook 중 하나를 선택하여 **상호작용 기반 Q&A**로 점진적으로 정의하고 생성하는 통합 커맨드/스킬.

### Complexity
- **예상 복잡도:** large
- **영향 파일:** 4개 (신규 생성)
  - `.claude/commands/create.md` - Command 정의
  - `.claude/skills/create.md` - Skill 구현
  - Template 파일들 (Agent/Skill/Hook)

### Q&A 핵심 (Round 1-2)
1. **Q:** 새 커맨드의 범위? → **A:** 하나의 통합 커맨드로 Agent/Skill/Hook 모두 커버
2. **Q:** 상호작용 방식? → **A:** Template 선택 → Socratic Q&A로 세부 조정

### 추천 접근법
Template-first approach: 각 타입(Agent/Skill/Hook)별 기본 템플릿 제공 → Q&A로 필드 채우기 → Plan Agent가 최종 파일 생성

### 핵심 기능
| 단계 | 설명 |
|------|------|
| 1. Type Selection | Agent / Skill / Hook 중 선택 |
| 2. Template Load | 선택된 타입의 기본 템플릿 로드 |
| 3. Q&A Rounds | 필수 필드를 Round별로 질문 |
| 4. Preview | 생성될 파일 미리보기 |
| 5. Generate | Plan Agent로 최종 파일 생성 |

### 리스크
- Hook 복잡성: bash/python 선택 필요
- Agent ODA 통합: governance 필드 누락 가능
- Skill 상태머신: 복잡한 워크플로우 표현 어려움

### 다음 단계
Round 3-5: 각 타입별 Q&A 패턴 설계

---

## DETAIL: Q&A 전체 로그 {#qa-log}

### Round 1 (2026-01-21 17:00)
**Q:** 새 커맨드/스킬의 범위는 어디까지인가요?
**A:** 기존 /plan-draft 확장이 아닌, Agent/Skill/Hook을 전문적으로 다루는 **하나의 통합 커맨드** 생성

### Round 2 (2026-01-21 17:05)
**Q:** 3개의 draft 커맨드 중 어떤 것부터?
**A:** 3개 분리가 아닌, **하나의 통합 커맨드**로 Agent/Skill/Hook 중 선택하여 상호작용하며 생성

---

## DETAIL: Component Templates {#templates}

### Agent Template
```yaml
---
name: {agent_name}
description: {role_description}
tools: [Read, Grep, Glob]  # Default minimal
skills:
  accessible: []
  via_delegation: []
oda_context:
  role: {gate | controller | logger | validator | executor}
  stage_access: [A, B, C]
  evidence_required: {true | false}
  audit_integration: {true | false}
  governance_mode: {strict | standard}
  proposal_mandate: {REQUIRED | OPTIONAL}
integrates_with:
  agents: []
  hooks: []
model: {haiku | sonnet | opus}
context: {standard | fork}
---

# {Agent Name}

## Purpose
{detailed_description}

## Behavior
{behavioral_rules}
```

### Skill Template
```yaml
---
skill_name: {skill_name}
description: {purpose}
user_invocable: {true | false}
allowed_tools: [Read, Grep, Glob, Task, Edit, Write]
context: {standard | fork}
model: {sonnet | opus}
version: "1.0.0"
---

# /{skill_name} Command

## Purpose
{description}

## Execution Flow
1. {step1}
2. {step2}
...

## Output Format
{output_structure}
```

### Hook Template (Bash)
```bash
#!/bin/bash
# {Hook Name} - {HookType}
#
# File: .claude/hooks/{path}/{name}.sh
# Version: 1.0.0
# Trigger: {PreToolUse | PostToolUse} on {tool_name}
#
# Purpose:
#   {description}

set -euo pipefail

# Read input
INPUT=$(cat)

# Extract fields
TOOL_NAME=$(echo "$INPUT" | jq -r '.tool_name // ""')

# Logic here
{logic}

# Output
echo '{"hookSpecificOutput":{"permissionDecision":"allow"}}'
```

### Hook Template (Python)
```python
#!/usr/bin/env python3
"""
{Hook Name} - {HookType}

File: .claude/hooks/{path}/{name}.py
Version: 1.0.0
Trigger: {PreToolUse | PostToolUse} on {tool_name}
"""

import sys
import json
from pathlib import Path

def main():
    input_data = json.load(sys.stdin)
    tool_name = input_data.get("tool_name", "")

    # Logic here
    {logic}

    # Output
    result = {
        "hookSpecificOutput": {
            "permissionDecision": "allow"
        }
    }
    print(json.dumps(result))

if __name__ == "__main__":
    main()
```

---

## DETAIL: Q&A Patterns by Type {#qa-patterns}

### Agent Q&A Flow
| Round | Question | Options |
|-------|----------|---------|
| 1 | Agent 이름? | 텍스트 입력 |
| 2 | Agent 역할? | gate / controller / logger / validator / executor |
| 3 | 접근 가능한 도구? | Read, Grep, Glob, Task, Edit, Write, Bash |
| 4 | ODA 스테이지 접근? | A, B, C (다중 선택) |
| 5 | 거버넌스 모드? | strict / standard |
| 6 | Proposal 필수? | REQUIRED / OPTIONAL |
| 7 | 연동 Agent? | 기존 Agent 목록에서 선택 |
| 8 | 연동 Hook? | PreToolUse / PostToolUse |
| 9 | 모델? | haiku / sonnet / opus |
| 10 | 컨텍스트? | standard / fork |

### Skill Q&A Flow
| Round | Question | Options |
|-------|----------|---------|
| 1 | Skill 이름? | 텍스트 입력 |
| 2 | 사용자 호출 가능? | true / false |
| 3 | 허용 도구? | Read, Grep, Glob, Task, Edit, Write, Bash |
| 4 | 컨텍스트? | standard / fork |
| 5 | 모델? | sonnet / opus |
| 6 | 승인 게이트? | MANDATORY / OPTIONAL / NONE |
| 7 | 실행 플로우? | Sequential / Socratic / Wizard |
| 8 | 출력 형식? | YAML / Markdown / JSON |

### Hook Q&A Flow
| Round | Question | Options |
|-------|----------|---------|
| 1 | Hook 이름? | 텍스트 입력 |
| 2 | Hook 타입? | PreToolUse / PostToolUse / SessionStart / SessionEnd / PreCompact |
| 3 | 트리거 도구? | Task / Bash / Edit / Write / Read / * (all) |
| 4 | 구현 언어? | Bash / Python |
| 5 | 주요 기능? | 검증 / 주입 / 로깅 / 변환 |
| 6 | updatedInput 사용? | true / false (PreToolUse only) |
| 7 | additionalContext 사용? | true / false (PreToolUse only) |
| 8 | 로그 경로? | .agent/logs/{name}.log |

---

## DETAIL: Plan Agent Integration {#plan-agent}

### Draft → Plan Flow
```
/create → Q&A → Draft 저장 → /plan --draft create_{type}_{name}
```

### Draft File Format (Plan Agent Optimized)
```markdown
# Create Draft: {type} - {name}

## INDEX (Plan Agent reads first)
- Type: {Agent | Skill | Hook}
- Name: {name}
- Status: READY_FOR_GENERATION
- Fields Completed: {N}/10

## Resolved Fields
| Field | Value | Round |
|-------|-------|-------|
| name | {value} | 1 |
| role | {value} | 2 |
...

## Template Preview
{filled_template}

## Generation Instructions
1. Create file at: {target_path}
2. Register in: {registry_if_applicable}
3. Test with: {test_command}
```

---

## DETAIL: File Structure {#file-structure}

### New Files to Create
```
.claude/
├── commands/
│   └── create.md          # Command definition (user-facing)
├── skills/
│   └── create.md          # Skill implementation
└── templates/
    ├── agent.yaml         # Agent template
    ├── skill.yaml         # Skill template
    ├── hook-bash.sh       # Bash hook template
    └── hook-python.py     # Python hook template
```

### Draft Storage
```
.agent/plans/
└── create_drafts/
    ├── agent_{name}.md
    ├── skill_{name}.md
    └── hook_{name}.md
```

---

## Metadata

- Created: 2026-01-21 17:00
- Last Updated: 2026-01-21 17:00
- Q&A Rounds: 2
- Status: IN_PROGRESS
- Next: Round 3-5 (세부 Q&A 패턴 확정)
