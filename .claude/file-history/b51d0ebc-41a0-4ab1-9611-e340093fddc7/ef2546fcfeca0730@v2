# =============================================================================
# Worker Task: Terminal-B - Phase 4 Custom Commands (E5)
# =============================================================================
# Location: .agent/prompts/pending/worker-b-phase4-commands.yaml
# Language: English (Machine-Readable)
# =============================================================================

taskId: "phase4-commands-e5"
assignedTo: "Terminal-B"
orchestrator: "Terminal-A"
createdAt: "2026-01-24T02:00:00Z"
priority: "P2"

# =============================================================================
# CONTEXT
# =============================================================================
context:
  proposalRef: ".agent/prompts/enhancement-proposal-v2.2.yaml"
  description: |
    Implement E5 (Custom Slash Commands for Orchestration).
    Create .claude/commands/ directory with orchestration commands.

  targetOutcome:
    - "/worker-status command created"
    - "/assign-task command created"
    - "/sync-tasks command created"
    - "Commands registered and invocable"

# =============================================================================
# DEPENDENCIES (NONE - Parallel with others)
# =============================================================================
dependencies: []
blockedBy: []
canStartImmediately: true

parallelNote: |
  Phase 1 (E1+E4) already completed by you.
  This task creates new files in .claude/commands/, no conflicts.

# =============================================================================
# COMMANDS TO CREATE
# =============================================================================
commands:
  - name: "worker-status"
    path: ".claude/commands/worker-status.md"
    purpose: "Check status of all worker terminals"
    content: |
      ---
      name: worker-status
      description: Check status of all worker terminals
      ---

      Read and summarize .agent/prompts/_progress.yaml:

      1. Show each terminal's current status
      2. List blocked tasks and their blockers
      3. Show completed deliverables
      4. Suggest next actions for idle workers

  - name: "assign-task"
    path: ".claude/commands/assign-task.md"
    purpose: "Assign a task to a worker terminal"
    content: |
      ---
      name: assign-task
      description: Assign a task to a worker terminal
      argument-hint: "[terminal] [task-description]"
      ---

      Create a worker task file:

      1. Parse arguments: $ARGUMENTS
      2. Generate task YAML in .agent/prompts/pending/worker-{terminal}-task.yaml
      3. Update _progress.yaml with assignment
      4. Output assignment confirmation

  - name: "sync-tasks"
    path: ".claude/commands/sync-tasks.md"
    purpose: "Synchronize task status across terminals"
    content: |
      ---
      name: sync-tasks
      description: Synchronize task list across all terminals
      ---

      1. Read CLAUDE_CODE_TASK_LIST_ID from session registry
      2. List all tasks with TaskList
      3. Show which tasks are assigned to which terminals
      4. Identify orphaned or stale tasks

# =============================================================================
# IMPLEMENTATION STEPS
# =============================================================================
steps:
  - step: 1
    action: "Create .claude/commands/ directory"
    command: "mkdir -p .claude/commands"

  - step: 2
    action: "Write worker-status.md"
    file: ".claude/commands/worker-status.md"

  - step: 3
    action: "Write assign-task.md"
    file: ".claude/commands/assign-task.md"

  - step: 4
    action: "Write sync-tasks.md"
    file: ".claude/commands/sync-tasks.md"

  - step: 5
    action: "Test command invocation"
    command: "/worker-status"
    expected: "Shows terminal statuses"

# =============================================================================
# VERIFICATION
# =============================================================================
verification:
  - command: "ls -la .claude/commands/"
    expected: "Three .md files exist"
  - command: "/worker-status"
    expected: "Outputs terminal status summary"

# =============================================================================
# OUTPUT FORMAT
# =============================================================================
outputFormat: "L1/L2/L3"
l2OutputPath: ".agent/outputs/Worker/phase4-commands.md"

# =============================================================================
# ON COMPLETE
# =============================================================================
onComplete:
  - "Update .agent/prompts/_progress.yaml: phase4.status = 'completed'"
  - "Report L1 summary to Orchestrator (Terminal-A)"
  - "Use /worker-done b to finalize"
