# MCP Tools Reference for Codex (GPT-5.2 xhigh)

> **Version:** 1.0 | **Date:** 2026-01-18
> **Purpose:** Claude Code 환경의 MCP 도구들을 Codex가 활용할 수 있도록 하는 참조 문서

---

## 1. MCP 서버 설치 위치 및 구성

### 1.1 전역 설정 파일

```
/home/palantir/.claude.json
```

### 1.2 설치된 MCP 서버 목록

| Server Name | NPM Package | Installation Path |
|-------------|-------------|-------------------|
| **github-mcp-server** | `@modelcontextprotocol/server-github` | `/home/palantir/.nvm/versions/node/v24.12.0/lib/node_modules/@modelcontextprotocol/server-github/` |
| **context7** | `@upstash/context7-mcp` | `/home/palantir/.nvm/versions/node/v24.12.0/lib/node_modules/@upstash/context7-mcp/` |
| **sequential-thinking** | `@modelcontextprotocol/server-sequential-thinking` | `/home/palantir/.nvm/versions/node/v24.12.0/lib/node_modules/@modelcontextprotocol/server-sequential-thinking/` |
| **tavily** | `tavily-mcp` | `/home/palantir/.nvm/versions/node/v24.12.0/lib/node_modules/tavily-mcp/` |

### 1.3 Node.js 런타임

```yaml
Node Binary: /home/palantir/.nvm/versions/node/v24.12.0/bin/node
Version: v24.12.0
Manager: nvm
```

---

## 2. MCP 서버 상세 설명

### 2.1 GitHub MCP Server

**목적:** GitHub API와의 완전한 통합

**실행 명령:**
```bash
/home/palantir/.nvm/versions/node/v24.12.0/bin/node \
  /home/palantir/.nvm/versions/node/v24.12.0/lib/node_modules/@modelcontextprotocol/server-github/dist/index.js
```

**제공 기능:**
- Repository 검색 및 생성
- Issue/PR 관리
- 파일 내용 조회 및 수정
- Branch 생성 및 관리
- Code 검색
- 사용자 검색

**주요 도구:**
| Tool Name | Description |
|-----------|-------------|
| `mcp__github-mcp-server__search_repositories` | GitHub 레포지토리 검색 |
| `mcp__github-mcp-server__create_repository` | 새 레포지토리 생성 |
| `mcp__github-mcp-server__get_file_contents` | 파일/디렉토리 내용 조회 |
| `mcp__github-mcp-server__push_files` | 여러 파일을 한 커밋으로 푸시 |
| `mcp__github-mcp-server__create_issue` | 이슈 생성 |
| `mcp__github-mcp-server__create_pull_request` | PR 생성 |
| `mcp__github-mcp-server__list_pull_requests` | PR 목록 조회 |
| `mcp__github-mcp-server__merge_pull_request` | PR 머지 |
| `mcp__github-mcp-server__create_branch` | 브랜치 생성 |
| `mcp__github-mcp-server__search_code` | 코드 검색 |

### 2.2 Context7 MCP Server

**목적:** 라이브러리/프레임워크의 최신 문서화 및 코드 예제 검색

**실행 명령:**
```bash
/home/palantir/.nvm/versions/node/v24.12.0/bin/node \
  /home/palantir/.nvm/versions/node/v24.12.0/lib/node_modules/@upstash/context7-mcp/dist/index.js
```

**제공 기능:**
- 라이브러리 ID 해석 (이름 → Context7 ID)
- 공식 문서 쿼리
- 코드 예제 검색

**주요 도구:**
| Tool Name | Description |
|-----------|-------------|
| `mcp__context7__resolve-library-id` | 패키지명을 Context7 ID로 변환 |
| `mcp__context7__query-docs` | 라이브러리 문서 및 예제 검색 |

**사용 순서:**
1. `resolve-library-id`로 라이브러리 ID 확인
2. `query-docs`로 실제 문서 쿼리

### 2.3 Sequential Thinking MCP Server

**목적:** 동적이고 반성적인 문제 해결을 위한 단계별 사고 도구

**실행 명령:**
```bash
/home/palantir/.nvm/versions/node/v24.12.0/bin/node \
  /home/palantir/.nvm/versions/node/v24.12.0/lib/node_modules/@modelcontextprotocol/server-sequential-thinking/dist/index.js
```

**제공 기능:**
- 복잡한 문제의 단계별 분석
- 사고 과정의 수정 및 분기
- 가설 생성 및 검증

**주요 도구:**
| Tool Name | Description |
|-----------|-------------|
| `mcp__sequential-thinking__sequentialthinking` | 단계별 사고 프로세스 |

**매개변수:**
```typescript
{
  thought: string,           // 현재 사고 단계
  nextThoughtNeeded: boolean,// 다음 단계 필요 여부
  thoughtNumber: number,     // 현재 번호
  totalThoughts: number,     // 예상 총 단계
  isRevision?: boolean,      // 수정 여부
  revisesThought?: number,   // 수정 대상 번호
  branchFromThought?: number,// 분기점
  branchId?: string,         // 분기 식별자
  needsMoreThoughts?: boolean// 추가 단계 필요
}
```

### 2.4 Tavily MCP Server

**목적:** 웹 검색 및 정보 수집

**실행 명령:**
```bash
/home/palantir/.nvm/versions/node/v24.12.0/bin/node \
  /home/palantir/.nvm/versions/node/v24.12.0/lib/node_modules/tavily-mcp/build/index.js
```

**제공 기능:**
- AI 기반 웹 검색
- 실시간 정보 수집
- 검색 결과 요약

**환경 변수:**
```bash
TAVILY_API_KEY=<your-api-key>  # .env 또는 환경 변수에서 설정
```

---

## 3. Codex에서 MCP 도구 활용 방법

### 3.1 직접 실행 방식 (Subprocess)

Codex는 MCP 서버를 직접 subprocess로 실행하여 JSON-RPC로 통신할 수 있습니다:

```python
import subprocess
import json

class MCPClient:
    """MCP 서버와 통신하는 클라이언트"""

    def __init__(self, server_name: str, node_path: str, server_path: str):
        self.server_name = server_name
        self.process = subprocess.Popen(
            [node_path, server_path],
            stdin=subprocess.PIPE,
            stdout=subprocess.PIPE,
            stderr=subprocess.PIPE,
            text=True
        )

    def call_tool(self, tool_name: str, params: dict) -> dict:
        """MCP 도구 호출"""
        request = {
            "jsonrpc": "2.0",
            "id": 1,
            "method": "tools/call",
            "params": {
                "name": tool_name,
                "arguments": params
            }
        }
        self.process.stdin.write(json.dumps(request) + "\n")
        self.process.stdin.flush()
        response = self.process.stdout.readline()
        return json.loads(response)

# 사용 예시
github_client = MCPClient(
    server_name="github",
    node_path="/home/palantir/.nvm/versions/node/v24.12.0/bin/node",
    server_path="/home/palantir/.nvm/versions/node/v24.12.0/lib/node_modules/@modelcontextprotocol/server-github/dist/index.js"
)

result = github_client.call_tool(
    "search_repositories",
    {"query": "language:python stars:>1000"}
)
```

### 3.2 환경 변수 설정

```bash
# .env 파일 또는 환경 변수
export GITHUB_TOKEN="ghp_xxxxxxxxxxxxxxxxxxxx"
export TAVILY_API_KEY="tvly-xxxxxxxxxxxxxxxxxxxx"

# Node.js 경로
export NODE_PATH="/home/palantir/.nvm/versions/node/v24.12.0/bin/node"
```

### 3.3 MCP 서버 초기화 시퀀스

```json
// 1. Initialize
{"jsonrpc":"2.0","id":1,"method":"initialize","params":{"protocolVersion":"2024-11-05","capabilities":{},"clientInfo":{"name":"codex","version":"1.0"}}}

// 2. List Tools
{"jsonrpc":"2.0","id":2,"method":"tools/list","params":{}}

// 3. Call Tool
{"jsonrpc":"2.0","id":3,"method":"tools/call","params":{"name":"search_repositories","arguments":{"query":"ontology"}}}
```

---

## 4. 도구별 사용 시나리오

### 4.1 코드베이스 분석

```python
# 1. GitHub에서 파일 구조 조회
files = github_client.call_tool(
    "get_file_contents",
    {"owner": "park-kyungchan", "repo": "palantir", "path": "lib/oda"}
)

# 2. Context7로 관련 라이브러리 문서 조회
lib_id = context7_client.call_tool(
    "resolve-library-id",
    {"libraryName": "pydantic", "query": "validation patterns"}
)

docs = context7_client.call_tool(
    "query-docs",
    {"libraryId": lib_id, "query": "model validation best practices"}
)
```

### 4.2 복잡한 문제 해결

```python
# Sequential Thinking으로 단계별 분석
thinking_client.call_tool(
    "sequentialthinking",
    {
        "thought": "ODA 시스템의 스키마 검증 로직을 분석합니다",
        "nextThoughtNeeded": True,
        "thoughtNumber": 1,
        "totalThoughts": 5
    }
)
```

### 4.3 PR 자동화

```python
# 브랜치 생성 → 파일 푸시 → PR 생성
github_client.call_tool("create_branch", {
    "owner": "park-kyungchan",
    "repo": "palantir",
    "branch": "feature/oda-enhancement"
})

github_client.call_tool("push_files", {
    "owner": "park-kyungchan",
    "repo": "palantir",
    "branch": "feature/oda-enhancement",
    "files": [{"path": "lib/oda/new_feature.py", "content": "..."}],
    "message": "feat: Add ODA enhancement"
})

github_client.call_tool("create_pull_request", {
    "owner": "park-kyungchan",
    "repo": "palantir",
    "title": "feat: ODA Enhancement",
    "head": "feature/oda-enhancement",
    "base": "main"
})
```

---

## 5. Codex 자율 실행을 위한 MCP 통합 프롬프트

```markdown
# MCP Tools Integration for Autonomous Execution

## Available MCP Servers

You have access to the following MCP servers installed at `/home/palantir/.nvm/versions/node/v24.12.0/`:

### 1. GitHub MCP Server
- **Path:** `lib/node_modules/@modelcontextprotocol/server-github/dist/index.js`
- **Capabilities:** Repository management, Issues, PRs, Code search
- **Auth:** Uses GITHUB_TOKEN environment variable

### 2. Context7 MCP Server
- **Path:** `lib/node_modules/@upstash/context7-mcp/dist/index.js`
- **Capabilities:** Library documentation lookup, Code examples
- **Usage:** Always call `resolve-library-id` before `query-docs`

### 3. Sequential Thinking MCP Server
- **Path:** `lib/node_modules/@modelcontextprotocol/server-sequential-thinking/dist/index.js`
- **Capabilities:** Step-by-step reasoning, Hypothesis verification
- **Usage:** For complex multi-step problem solving

### 4. Tavily MCP Server
- **Path:** `lib/node_modules/tavily-mcp/build/index.js`
- **Capabilities:** Web search, Real-time information
- **Auth:** Uses TAVILY_API_KEY environment variable

## Communication Protocol

All MCP servers use JSON-RPC 2.0 over stdio:

1. Start server: `node <server-path>`
2. Initialize: Send initialize request
3. List tools: Get available tools
4. Call tools: Execute with arguments
5. Process results: Handle JSON responses

## Tool Naming Convention

Tools follow the pattern: `mcp__<server-name>__<tool-name>`

Examples:
- `mcp__github-mcp-server__search_repositories`
- `mcp__context7__query-docs`
- `mcp__sequential-thinking__sequentialthinking`

## Best Practices

1. **Error Handling:** Always check response for errors before processing
2. **Rate Limiting:** GitHub API has rate limits; cache results when possible
3. **Context7:** Always resolve library ID first before querying docs
4. **Sequential Thinking:** Use for complex problems requiring multiple reasoning steps
5. **Tavily:** Use for real-time information not available in training data
```

---

## 6. 설치 재현 명령어

만약 다른 환경에서 동일하게 설정해야 할 경우:

```bash
# Node.js 24.x 설치 (nvm 사용)
nvm install 24
nvm use 24

# MCP 서버들 전역 설치
npm install -g @modelcontextprotocol/server-github
npm install -g @modelcontextprotocol/server-sequential-thinking
npm install -g @upstash/context7-mcp
npm install -g tavily-mcp

# .claude.json 설정 (자동 생성됨)
# Claude Code 실행 시 MCP 서버 자동 감지 및 등록
```

---

## 7. 트러블슈팅

| 문제 | 원인 | 해결 |
|------|------|------|
| "Server not found" | 경로 오류 | `node_path`와 `server_path` 확인 |
| "Authentication failed" | 토큰 미설정 | 환경 변수에 API 키 설정 |
| "Rate limit exceeded" | API 호출 초과 | 캐싱 또는 대기 시간 추가 |
| "Invalid JSON-RPC" | 프로토콜 오류 | 요청 형식 확인 |

---

> **Note:** 이 문서는 Codex (GPT-5.2 xhigh)가 Claude Code 환경의 MCP 도구들을
> 자율적으로 활용할 수 있도록 작성되었습니다.
