# /ontology-objecttype - ObjectType Definition Assistant

> **Version:** 1.1.0
> **Model:** opus
> **User-Invocable:** true

---

## 1. Purpose

ê¸°ì¡´ í”„ë¡œì íŠ¸ë¥¼ **Ontology-Driven-Architecture (ODA)**ë¡œ ë§ˆì´ê·¸ë ˆì´ì…˜í•˜ëŠ” ì²« ë‹¨ê³„:
**"ë¬´ì—‡ì„ ObjectTypeìœ¼ë¡œ ì •ì˜í•  ê²ƒì¸ê°€?"**ë¥¼ ë„ì¶œí•˜ê³  ìŠ¹ì¸ë°›ëŠ” Interactive Assistant.

### í•µì‹¬ ì›ì¹™: ì‹¤ì‹œê°„ ì¶”ë¡  ê¸°ë°˜ ë¶„ì„

| ì›ì¹™ | ì„¤ëª… |
|------|------|
| **ëª©ì ** | **Ontology ObjectTypeì„ ì •í™•íˆ ì •ì˜**í•˜ê¸° ìœ„í•œ ë¶„ì„ |
| **ë°©ì‹** | ë¯¸ë¦¬ ì •ì˜ëœ ë‹µì´ ì•„ë‹Œ, **ë§¤ í”„ë¡¬í”„íŠ¸ë§ˆë‹¤ ì‹¤ì‹œê°„ ì¶”ë¡ ** |
| **ë²”ìœ„** | í•´ë‹¹ í´ë˜ìŠ¤ê°€ ObjectTypeì¸ê°€? DataTypeì€? CardinalityëŠ”? |
| **ì¶œë ¥** | L1â†’L2â†’L3 Progressive Disclosure + íŒë‹¨ ê·¼ê±° |

> **Note**: Palantir AIP/Foundryë¥¼ ì‚¬ìš©í•˜ëŠ” ê¸°ì—…ë“¤ì²˜ëŸ¼, ê° í´ë˜ìŠ¤ì™€ ì†ì„±ì„
> **ê·¸ë•Œê·¸ë•Œ ì¡°ì‚¬/ë¶„ì„**í•˜ì—¬ ObjectType ì •ì˜ì˜ ì •í™•ì„±ì„ ë†’ì…ë‹ˆë‹¤.

---

## 2. Invocation

```bash
# í”„ë¡œì íŠ¸ ë¶„ì„ ì‹œì‘
/ontology-objecttype analyze /home/palantir/my-project

# íŠ¹ì • íŒŒì¼ë§Œ ë¶„ì„
/ontology-objecttype analyze /home/palantir/my-project/models.py

# ì´ì „ ë¶„ì„ ì´ì–´ì„œ ì§„í–‰
/ontology-objecttype resume <session-id>

# ë„ì›€ë§
/ontology-objecttype help
```

---

## 3. Command Parsing

```python
args = "{user_args}"
command = args.split()[0] if args else "help"

commands = {
    "analyze": "í”„ë¡œì íŠ¸/íŒŒì¼ ë¶„ì„í•˜ì—¬ ObjectType í›„ë³´ ë„ì¶œ",
    "resume": "ì´ì „ ë¶„ì„ ì„¸ì…˜ ì´ì–´ì„œ ì§„í–‰",
    "help": "ì‚¬ìš©ë²• ì•ˆë‚´"
}

if command == "analyze":
    target_path = args.split()[1] if len(args.split()) > 1 else None
    if not target_path:
        # Prompt for path
        pass
    # Start analysis workflow

elif command == "resume":
    session_id = args.split()[1] if len(args.split()) > 1 else None
    # Load session state

elif command == "help":
    # Show usage
    pass
```

---

## 4. Analysis Patterns

### 4.1 Detection Targets

| Pattern | Detection Method | Example |
|---------|-----------------|---------|
| **Python class** | `class ClassName:` | `class Employee:` |
| **SQLAlchemy ORM** | `Base` ë˜ëŠ” `declarative_base()` ìƒì† | `class User(Base):` |
| **Django ORM** | `models.Model` ìƒì† | `class Article(models.Model):` |
| **Pydantic** | `BaseModel` ìƒì† | `class Config(BaseModel):` |

### 4.2 Property Extraction

ê° í´ë˜ìŠ¤ì—ì„œ ì¶”ì¶œí•˜ëŠ” ì •ë³´:

| í•­ëª© | Source | Foundry Mapping |
|------|--------|-----------------|
| **í´ë˜ìŠ¤ëª…** | Class definition | `ObjectType.api_name` |
| **í•„ë“œ/ì†ì„±** | Class attributes | `PropertyDefinition` |
| **íƒ€ì… íŒíŠ¸** | Type annotations | `DataType` |
| **PK í›„ë³´** | `id`, `pk`, `*_id` íŒ¨í„´ | `primary_key` |
| **FK/ê´€ê³„** | ForeignKey, relationship | `LinkType` í›„ë³´ |

### 4.3 Grep Patterns

```python
PATTERNS = {
    "python_class": r"^class\s+([A-Z][a-zA-Z0-9_]*)\s*[:\(]",
    "sqlalchemy": r"class\s+(\w+)\s*\(\s*(?:Base|.*declarative_base)",
    "django": r"class\s+(\w+)\s*\(\s*models\.Model\s*\)",
    "pydantic": r"class\s+(\w+)\s*\(\s*(?:BaseModel|.*BaseModel)",
    "field_def": r"^\s+(\w+)\s*[=:]\s*",
    "type_hint": r":\s*([A-Za-z_][A-Za-z0-9_\[\], ]*)",
    "foreign_key": r"ForeignKey\s*\(\s*['\"]?(\w+)",
    "relationship": r"relationship\s*\(\s*['\"](\w+)"
}
```

---

## 5. Workflow: L1 â†’ L2 â†’ L3 Progressive Disclosure

### 5.1 L1 - Summary (ì²« ë²ˆì§¸ ì¶œë ¥)

```
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘  ObjectType í›„ë³´ ë¶„ì„ ì™„ë£Œ                                    â•‘
â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£
â•‘  ğŸ“ ë¶„ì„ ëŒ€ìƒ: /home/palantir/my-project                      â•‘
â•‘  ğŸ“Š ë°œê²¬ëœ í´ë˜ìŠ¤: 12ê°œ                                       â•‘
â•‘  âœ… ObjectType í›„ë³´: 8ê°œ                                      â•‘
â•‘  âš ï¸ ê²€í†  í•„ìš”: 2ê°œ                                            â•‘
â•‘  âŒ ì œì™¸ ì¶”ì²œ: 2ê°œ (Helper/Utility í´ë˜ìŠ¤)                    â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ” ë¶„ì„ ìš”ì•½: [ì‹¤ì‹œê°„ ì¶”ë¡ ìœ¼ë¡œ í•´ë‹¹ í”„ë¡œì íŠ¸ íŠ¹ì„±ì— ë§ëŠ” íŒë‹¨ ì œê³µ]

ë‹¤ìŒ ë‹¨ê³„: "L2" ì…ë ¥í•˜ì—¬ ìƒì„¸ ëª©ë¡ í™•ì¸
```

### 5.2 L2 - Detailed List (ë‘ ë²ˆì§¸ ì¶œë ¥)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ObjectType í›„ë³´ ìƒì„¸ ëª©ë¡                                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                             â”‚
â”‚  âœ… ê¶Œì¥ ObjectType (8ê°œ)                                   â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€              â”‚
â”‚  1. Employee (models/employee.py:15)                        â”‚
â”‚     â””â”€ Properties: 6ê°œ | PK: employee_id | FK: department_idâ”‚
â”‚                                                             â”‚
â”‚  2. Department (models/department.py:8)                     â”‚
â”‚     â””â”€ Properties: 4ê°œ | PK: department_id | FK: -          â”‚
â”‚                                                             â”‚
â”‚  3. Project (models/project.py:22)                          â”‚
â”‚     â””â”€ Properties: 8ê°œ | PK: project_id | FK: owner_id      â”‚
â”‚     â””â”€ ğŸ”— Relationship: Employee (N:1)                      â”‚
â”‚  ...                                                        â”‚
â”‚                                                             â”‚
â”‚  âš ï¸ ê²€í†  í•„ìš” (2ê°œ)                                         â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€              â”‚
â”‚  A. EmployeeDTO (dto/employee_dto.py:5)                     â”‚
â”‚     â””â”€ ì´ìœ : DTO íŒ¨í„´, ë³„ë„ ObjectType ë˜ëŠ” ì œì™¸ ê²€í†        â”‚
â”‚                                                             â”‚
â”‚  B. AuditMixin (mixins/audit.py:3)                          â”‚
â”‚     â””â”€ ì´ìœ : Mixin íŒ¨í„´, SharedPropertyë¡œ ë³€í™˜ ê²€í†          â”‚
â”‚                                                             â”‚
â”‚  âŒ ì œì™¸ ì¶”ì²œ (2ê°œ)                                         â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€              â”‚
â”‚  - DatabaseHelper (utils/db.py:10) - ìœ í‹¸ë¦¬í‹°               â”‚
â”‚  - ConfigLoader (config/loader.py:5) - ì„¤ì • ë¡œë”            â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

ğŸ” ì œì™¸/ê²€í†  íŒë‹¨ ê·¼ê±°: [ì‹¤ì‹œê°„ ì¶”ë¡ ìœ¼ë¡œ ê° í´ë˜ìŠ¤ì˜ ì œì™¸ ì´ìœ  ë¶„ì„]

ë‹¤ìŒ ë‹¨ê³„: ë²ˆí˜¸ ì…ë ¥í•˜ì—¬ L3 ìƒì„¸ í™•ì¸ (ì˜ˆ: "1" ë˜ëŠ” "1,2,3")
ë˜ëŠ”: "approve all" / "approve 1,2,3" / "exclude A,B"
```

### 5.3 L3 - Deep Dive with Learning (ì„¸ ë²ˆì§¸ ì¶œë ¥)

```
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘  L3: Employee ObjectType ìƒì„¸                                â•‘
â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£
â•‘                                                              â•‘
â•‘  ğŸ“ Source: models/employee.py:15                            â•‘
â•‘                                                              â•‘
â•‘  â”Œâ”€ Original Code â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â•‘
â•‘  â”‚ class Employee(Base):                                   â”‚ â•‘
â•‘  â”‚     __tablename__ = 'employees'                         â”‚ â•‘
â•‘  â”‚     employee_id = Column(String, primary_key=True)      â”‚ â•‘
â•‘  â”‚     name = Column(String(100), nullable=False)          â”‚ â•‘
â•‘  â”‚     email = Column(String, unique=True)                 â”‚ â•‘
â•‘  â”‚     department_id = Column(String, ForeignKey(...))     â”‚ â•‘
â•‘  â”‚     hire_date = Column(Date)                            â”‚ â•‘
â•‘  â”‚     is_active = Column(Boolean, default=True)           â”‚ â•‘
â•‘  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â•‘
â•‘                                                              â•‘
â•‘  â”Œâ”€ Proposed ObjectType â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â•‘
â•‘  â”‚ employee_type = ObjectType(                             â”‚ â•‘
â•‘  â”‚     api_name="Employee",                                â”‚ â•‘
â•‘  â”‚     display_name="Employee",                            â”‚ â•‘
â•‘  â”‚     primary_key=PrimaryKeyDefinition(                   â”‚ â•‘
â•‘  â”‚         property_api_name="employeeId"                  â”‚ â•‘
â•‘  â”‚     ),                                                  â”‚ â•‘
â•‘  â”‚     properties=[...]  # ì•„ë˜ ìƒì„¸                       â”‚ â•‘
â•‘  â”‚ )                                                       â”‚ â•‘
â•‘  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â•‘
â•‘                                                              â•‘
â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£
â•‘  ğŸ“‹ Properties (6ê°œ)                                         â•‘
â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£
â•‘                                                              â•‘
â•‘  1. employeeId (String) â­ Primary Key                       â•‘
â•‘     â”œâ”€ Source: employee_id                                   â•‘
â•‘     â”œâ”€ Foundry Type: STRING                                  â•‘
â•‘     â””â”€ Constraints: required=True, unique=True               â•‘
â•‘                                                              â•‘
â•‘     ğŸ” ì¶”ë¡ : PKë¡œ ì í•©í•œê°€?                                  â•‘
â•‘        â†’ [ì‹¤ì‹œê°„ ë¶„ì„ ê²°ê³¼ê°€ ì—¬ê¸°ì— í‘œì‹œë¨]                  â•‘
â•‘                                                              â•‘
â•‘  2. name (String)                                            â•‘
â•‘     â”œâ”€ Source: name                                          â•‘
â•‘     â”œâ”€ Foundry Type: STRING                                  â•‘
â•‘     â””â”€ Constraints: required=True                            â•‘
â•‘                                                              â•‘
â•‘  3. email (String)                                           â•‘
â•‘     â”œâ”€ Source: email                                         â•‘
â•‘     â”œâ”€ Foundry Type: STRING                                  â•‘
â•‘     â””â”€ Constraints: unique=True                              â•‘
â•‘                                                              â•‘
â•‘     ğŸ” ì¶”ë¡ : unique ì œì•½ì´ ë§ëŠ”ê°€?                           â•‘
â•‘        â†’ [ì‹¤ì‹œê°„ ë¶„ì„ ê²°ê³¼ê°€ ì—¬ê¸°ì— í‘œì‹œë¨]                  â•‘
â•‘                                                              â•‘
â•‘  4. departmentId (String) ğŸ”— Foreign Key                     â•‘
â•‘     â”œâ”€ Source: department_id                                 â•‘
â•‘     â”œâ”€ Foundry Type: STRING                                  â•‘
â•‘     â””â”€ LinkType í›„ë³´: Employee â†’ Department                  â•‘
â•‘                                                              â•‘
â•‘     ğŸ” ì¶”ë¡ : ì–´ë–¤ Cardinalityì¸ê°€?                           â•‘
â•‘        â†’ [ì‹¤ì‹œê°„ ë¶„ì„: MANY_TO_ONE íŒë‹¨ ê·¼ê±°]                â•‘
â•‘                                                              â•‘
â•‘  5. hireDate (Date)                                          â•‘
â•‘     â”œâ”€ Source: hire_date                                     â•‘
â•‘     â”œâ”€ Foundry Type: DATE                                    â•‘
â•‘     â””â”€ Constraints: -                                        â•‘
â•‘                                                              â•‘
â•‘     ğŸ” ì¶”ë¡ : DATE vs TIMESTAMP?                              â•‘
â•‘        â†’ [ì‹¤ì‹œê°„ ë¶„ì„: ì‹œê°„ëŒ€ í•„ìš” ì—¬ë¶€ íŒë‹¨]                â•‘
â•‘                                                              â•‘
â•‘  6. isActive (Boolean)                                       â•‘
â•‘     â”œâ”€ Source: is_active                                     â•‘
â•‘     â”œâ”€ Foundry Type: BOOLEAN                                 â•‘
â•‘     â””â”€ Default: True                                         â•‘
â•‘                                                              â•‘
â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£
â•‘  ğŸ”— Detected Relationships                                   â•‘
â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£
â•‘                                                              â•‘
â•‘  Employee â†’ Department (MANY_TO_ONE)                         â•‘
â•‘  â”œâ”€ Via: departmentId                                        â•‘
â•‘  â””â”€ LinkType í›„ë³´: EmployeeToDepartment                      â•‘
â•‘                                                              â•‘
â•‘  ğŸ” ì¶”ë¡  ê·¼ê±°:                                               â•‘
â•‘     â†’ í•œ Departmentì— ì—¬ëŸ¬ Employee ì†Œì† ê°€ëŠ¥                â•‘
â•‘     â†’ EmployeeëŠ” í•˜ë‚˜ì˜ Departmentì—ë§Œ ì†Œì†                  â•‘
â•‘     â†’ FKê°€ Employee(Many) ìª½ì— ìœ„ì¹˜ â†’ MANY_TO_ONE            â•‘
â•‘                                                              â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ì„ íƒí•˜ì„¸ìš”:
  [A] Approve - ì´ ObjectType ìŠ¹ì¸
  [E] Edit - Property ìˆ˜ì • (ì§ì ‘ í¸ì§‘)
  [S] Skip - ë‚˜ì¤‘ì— ê²°ì •
  [?] Question - ì¶”ê°€ í•™ìŠµ ì§ˆë¬¸
```

---

## 6. ì‹¤ì‹œê°„ ì¶”ë¡  í”„ë¡œí† ì½œ

### 6.1 ë¶„ì„ ì‹œ íŒë‹¨í•´ì•¼ í•  ì§ˆë¬¸ë“¤

ê° í´ë˜ìŠ¤/ì†ì„±ì„ ë¶„ì„í•  ë•Œ **ì‹¤ì‹œê°„ìœ¼ë¡œ ì¶”ë¡ **í•˜ì—¬ ë‹µë³€:

| íŒë‹¨ í•­ëª© | ì¶”ë¡  ì§ˆë¬¸ |
|----------|----------|
| **ObjectType ì í•©ì„±** | ì´ í´ë˜ìŠ¤ê°€ ë¹„ì¦ˆë‹ˆìŠ¤ ë„ë©”ì¸ì˜ í•µì‹¬ ì—”í‹°í‹°ì¸ê°€? |
| **Primary Key** | ì–´ë–¤ ì†ì„±ì´ PKë¡œ ì í•©í•œê°€? ê·¸ ê·¼ê±°ëŠ”? |
| **DataType ë§¤í•‘** | Python íƒ€ì… â†’ Foundry DataType ë§¤í•‘ì´ ì •í™•í•œê°€? |
| **Required ì—¬ë¶€** | nullable=Falseì¸ í•„ë“œê°€ ì‹¤ì œë¡œ requiredì¸ê°€? |
| **Relationship** | FKê°€ ì–´ë–¤ Cardinalityë¥¼ ë‚˜íƒ€ë‚´ëŠ”ê°€? |
| **ì œì™¸ íŒë‹¨** | Helper/DTO/Mixinì¸ê°€? ì™œ ObjectTypeì´ ì•„ë‹Œê°€? |

### 6.2 ì¶”ë¡  ì¶œë ¥ í˜•ì‹

```
â”Œâ”€ ë¶„ì„: Employee í´ë˜ìŠ¤ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                             â”‚
â”‚  Q: ì´ í´ë˜ìŠ¤ê°€ ObjectTypeìœ¼ë¡œ ì í•©í•œê°€?                    â”‚
â”‚  A: âœ… ì í•©í•¨                                               â”‚
â”‚     - ê·¼ê±° 1: ë¹„ì¦ˆë‹ˆìŠ¤ ë„ë©”ì¸ì˜ í•µì‹¬ ì—”í‹°í‹° (ì§ì›)          â”‚
â”‚     - ê·¼ê±° 2: ê³ ìœ  ì‹ë³„ì(employee_id) ë³´ìœ                  â”‚
â”‚     - ê·¼ê±° 3: ë…ë¦½ì ì¸ ìƒëª…ì£¼ê¸° (CRUD ëŒ€ìƒ)                 â”‚
â”‚                                                             â”‚
â”‚  Q: department_idëŠ” ì–´ë–¤ ê´€ê³„ë¥¼ ë‚˜íƒ€ë‚´ëŠ”ê°€?                 â”‚
â”‚  A: MANY_TO_ONE (Employee â†’ Department)                     â”‚
â”‚     - ê·¼ê±°: í•œ ë¶€ì„œì— ì—¬ëŸ¬ ì§ì›, ì§ì›ì€ í•˜ë‚˜ì˜ ë¶€ì„œ ì†Œì†    â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 6.3 Interactive Q&A (`?` ëª…ë ¹)

ì‚¬ìš©ìê°€ `?`ë¥¼ ì…ë ¥í•˜ë©´ **í•´ë‹¹ ë§¥ë½ì—ì„œ ì‹¤ì‹œê°„ ì¶”ë¡ **ìœ¼ë¡œ ì‘ë‹µ:

```
> ? ì´ email í•„ë“œê°€ uniqueì—¬ì•¼ í•˜ë‚˜ìš”?

[ì‹¤ì‹œê°„ ë¶„ì„]
í˜„ì¬ ì½”ë“œ: email = Column(String, unique=True)

ë¶„ì„ ê²°ê³¼:
- í˜„ì¬ DB ìŠ¤í‚¤ë§ˆì—ì„œ unique=Trueë¡œ ì„¤ì •ë¨
- ë¹„ì¦ˆë‹ˆìŠ¤ ê·œì¹™ìƒ ì§ì› ì´ë©”ì¼ì€ ê³ ìœ í•´ì•¼ í•¨ (ì¼ë°˜ì )
- ObjectType ì •ì˜ ì‹œ: constraints=PropertyConstraints(unique=True)

ê¶Œì¥: unique=True ìœ ì§€
```

---

## 7. Approval Workflow

### 7.1 Commands

| Command | Description |
|---------|-------------|
| `L2` | L1ì—ì„œ L2 ìƒì„¸ ëª©ë¡ìœ¼ë¡œ |
| `1` ë˜ëŠ” `1,2,3` | íŠ¹ì • í•­ëª© L3 ìƒì„¸ ë³´ê¸° |
| `approve all` | ëª¨ë“  ê¶Œì¥ í•­ëª© ìŠ¹ì¸ |
| `approve 1,2,3` | íŠ¹ì • í•­ëª©ë§Œ ìŠ¹ì¸ |
| `exclude A,B` | ê²€í†  í•„ìš” í•­ëª© ì œì™¸ |
| `edit 1` | íŠ¹ì • í•­ëª© Property í¸ì§‘ |
| `?` | í•™ìŠµ ì§ˆë¬¸ ëª¨ë“œ |
| `done` | ìŠ¹ì¸ ì™„ë£Œ, scaffold ìƒì„± |

### 7.2 Session State

```json
{
  "session_id": "obj-a1b2c3",
  "target_path": "/home/palantir/my-project",
  "analyzed_files": ["models/employee.py", "models/department.py"],
  "candidates": [
    {
      "name": "Employee",
      "source": "models/employee.py:15",
      "status": "approved",
      "properties": [...],
      "relationships": [...]
    }
  ],
  "excluded": ["DatabaseHelper", "ConfigLoader"],
  "current_level": "L2",
  "timestamp": "2026-01-25T16:00:00Z"
}
```

---

## 8. Output Generation

### 8.1 On `done` Command

```python
async def generate_approved_types():
    for candidate in approved_candidates:
        # 1. Generate ObjectType scaffold
        scaffold = generate_objecttype_scaffold(candidate)

        # 2. Write to output directory
        output_path = f".agent/ontology/{candidate.name.lower()}.py"
        await Write({ "file_path": output_path, "content": scaffold })

        # 3. Generate LinkType scaffolds for relationships
        for rel in candidate.relationships:
            link_scaffold = generate_linktype_scaffold(rel)
            link_path = f".agent/ontology/links/{rel.name.lower()}.py"
            await Write({ "file_path": link_path, "content": link_scaffold })

    # 4. Generate summary report
    report = generate_migration_report(approved_candidates)
    await Write({ "file_path": ".agent/ontology/MIGRATION_REPORT.md", "content": report })
```

### 8.2 Output Structure

```
.agent/ontology/
â”œâ”€â”€ employee.py              # ObjectType definition
â”œâ”€â”€ department.py            # ObjectType definition
â”œâ”€â”€ project.py               # ObjectType definition
â”œâ”€â”€ links/
â”‚   â”œâ”€â”€ employee_to_department.py
â”‚   â””â”€â”€ project_to_employee.py
â””â”€â”€ MIGRATION_REPORT.md      # Summary with learning notes
```

---

## 9. Integration with /ontology-core

```bash
# After /ontology-objecttype generates files:

# Validate generated ObjectTypes
/ontology-core validate-all .agent/ontology/

# Check link consistency
/ontology-core check-links .agent/ontology/
```

---

## 10. Tools Allowed

| Tool | Purpose |
|------|---------|
| `Read` | ì†ŒìŠ¤ íŒŒì¼ ì½ê¸° |
| `Glob` | í”„ë¡œì íŠ¸ íŒŒì¼ íƒìƒ‰ |
| `Grep` | íŒ¨í„´ ê²€ìƒ‰ (class, ORM ë“±) |
| `Write` | ObjectType scaffold ìƒì„± |
| `AskUserQuestion` | L1/L2/L3 ìŠ¹ì¸ ì›Œí¬í”Œë¡œìš° |

---

## 11. Error Handling

| Error | Recovery |
|-------|----------|
| ê²½ë¡œ ì—†ìŒ | "ê²½ë¡œë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤. í™•ì¸í•´ì£¼ì„¸ìš”." |
| Python íŒŒì¼ ì—†ìŒ | "ë¶„ì„ ê°€ëŠ¥í•œ Python íŒŒì¼ì´ ì—†ìŠµë‹ˆë‹¤." |
| í´ë˜ìŠ¤ ì—†ìŒ | "ObjectType í›„ë³´ê°€ ë°œê²¬ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤." |
| ì„¸ì…˜ ë§Œë£Œ | "ìƒˆ ë¶„ì„ì„ ì‹œì‘í•˜ê±°ë‚˜ --resumeìœ¼ë¡œ ì¬ê°œí•˜ì„¸ìš”." |

---

## 12. Future Roadmap

| ìŠ¤í‚¬ | ë²”ìœ„ | ìƒíƒœ |
|------|------|------|
| `/ontology-objecttype` | ObjectType ë„ì¶œ + Learning | âœ… í˜„ì¬ |
| `/ontology-linktype` | LinkType ë„ì¶œ (ê´€ê³„ ë¶„ì„) | ğŸ”œ ê³„íšë¨ |
| `/ontology-actiontype` | ActionType ë„ì¶œ (CRUD ë¶„ì„) | ğŸ”œ ê³„íšë¨ |

---

**End of Skill Definition**
