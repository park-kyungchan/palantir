# =============================================================================
# Global Context: Shift Left Philosophy - Skill Integration
# =============================================================================
# SEPARATE PROJECT CONTEXT - Does not overwrite main _context.yaml
# Generated by /orchestrate
# Plan Source: .agent/plans/shift-left-philosophy.yaml
# =============================================================================

version: "1.0"
project: "shift-left-philosophy"
orchestrator: "Terminal-A"
createdAt: "2026-01-25T16:40:00Z"
lastUpdated: "2026-01-25T16:40:00Z"

# =============================================================================
# OBJECTIVES
# =============================================================================
objectives:
  primary:
    - "/clarify에 Gate 1 (requirement feasibility) 통합"
    - "/research에 Gate 2 (scope access) 통합"
    - "/planning에 Gate 3 (pre-flight checks) 통합"
    - "/orchestrate에 Gate 4 (dependency validation) 통합"
    - "/worker에 Gate 5 (pre-execution gate) 통합"
    - "Observability 추가 (validation metrics)"

# =============================================================================
# PHASES
# =============================================================================
phases:
  phase1-clarify-research-gates:
    id: "phase1-clarify-research-gates"
    name: "Gate 1-2 Integration: /clarify, /research"
    owner: "terminal-b"
    nativeTaskId: "1"
    status: "pending"
    dependencies: []
    targetFiles:
      - ".claude/skills/clarify/SKILL.md"
      - ".claude/hooks/clarify-validate.sh"
      - ".claude/skills/research/SKILL.md"
      - ".claude/hooks/research-validate.sh"
    priority: "P0"

  phase2-planning-orchestrate-gates:
    id: "phase2-planning-orchestrate-gates"
    name: "Gate 3-4 Integration: /planning, /orchestrate"
    owner: "terminal-c"
    nativeTaskId: "2"
    status: "pending"
    dependencies: []
    targetFiles:
      - ".claude/skills/planning/SKILL.md"
      - ".claude/hooks/planning-preflight.sh"
      - ".claude/skills/orchestrate/SKILL.md"
      - ".claude/hooks/orchestrate-validate.sh"
    priority: "P0"

  phase3-worker-gate:
    id: "phase3-worker-gate"
    name: "Gate 5 Integration: /worker"
    owner: "terminal-b"
    nativeTaskId: "3"
    status: "pending"
    dependencies: ["phase1-clarify-research-gates"]
    targetFiles:
      - ".claude/skills/worker/SKILL.md"
      - ".claude/hooks/worker-preflight.sh"
    priority: "P1"

  phase4-observability:
    id: "phase4-observability"
    name: "Validation Metrics & Dashboard"
    owner: "terminal-c"
    nativeTaskId: "4"
    status: "pending"
    dependencies: ["phase2-planning-orchestrate-gates"]
    targetFiles:
      - ".claude/hooks/validation-metrics.sh"
      - ".agent/prompts/_progress.yaml"
    priority: "P2"

  phase5-e2e-testing:
    id: "phase5-e2e-testing"
    name: "Shift-Left E2E Integration Test"
    owner: "orchestrator"
    nativeTaskId: "5"
    status: "pending"
    dependencies: ["phase1-clarify-research-gates", "phase2-planning-orchestrate-gates", "phase3-worker-gate", "phase4-observability"]
    targetFiles:
      - ".claude/tests/shift-left-e2e-test.sh"
      - ".claude/tests/README.md"
    priority: "P0"

# =============================================================================
# DEPENDENCY GRAPH
# =============================================================================
dependencyGraph: |
  Phase 1 (Terminal-B) ─────┬──→ Phase 3 (Terminal-B) ───┐
                            │                             │
                            │                             ├──→ Phase 5 (Orchestrator)
                            │                             │
  Phase 2 (Terminal-C) ─────┴──→ Phase 4 (Terminal-C) ───┘

  Note: Phase 1 and Phase 2 can run in PARALLEL

# =============================================================================
# SHARED RULES
# =============================================================================
sharedRules:
  - "ALWAYS Read target file before modifying"
  - "Source validation-gates.sh before calling gate functions"
  - "Update _progress-shift-left-philosophy.yaml after completion"
  - "Report in L1/L2/L3 format"
  - "Check blockedBy before starting work"

# =============================================================================
# REFERENCE FILES
# =============================================================================
referenceFiles:
  - path: ".agent/plans/shift-left-philosophy.yaml"
    reason: "Planning document with phase details"
  - path: ".agent/research/shift-left-philosophy.md"
    reason: "Research findings with gate function specs"
  - path: ".claude/skills/shared/validation-gates.sh"
    reason: "Validation gate functions to integrate"

# =============================================================================
# AUTONOMOUS EXECUTION PROTOCOL
# =============================================================================
autonomousProtocol:
  enabled: true
  pollIntervalSeconds: 30

  executionLoop: |
    WHILE project NOT completed:
      1. TaskList() → 전체 Task 상태 확인
      2. Filter by owner == MY_TERMINAL
      3. FOR each myTask:
           IF myTask.status == "pending":
             IF myTask.blockedBy ALL completed:
               → TaskUpdate(taskId, status="in_progress")
               → Execute task
               → TaskUpdate(taskId, status="completed")
             ELSE:
               → Log "Waiting for blockers: {blockedBy}"
      4. IF all myTasks completed:
           → Report final status
      5. Sleep(pollIntervalSeconds)

# =============================================================================
# END OF CONTEXT
# =============================================================================
