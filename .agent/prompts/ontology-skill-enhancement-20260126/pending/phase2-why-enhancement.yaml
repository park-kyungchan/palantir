# =============================================================================
# Worker Task: Phase 2 - /ontology-why Integrity ë¶„ì„ ê°•í™”
# =============================================================================
# Workload: ontology-skill-enhancement-20260126
# Native Task ID: 2
# Created: 2026-01-26T11:20:00Z
# =============================================================================

taskId: "phase2-why-enhancement"
nativeTaskId: "2"
assignedTo: "terminal-c"
orchestrator: "Terminal-A"
createdAt: "2026-01-26T11:20:00Z"
assignedAt: "2026-01-26T11:20:00Z"

# =============================================================================
# CONTEXT REFERENCE
# =============================================================================

workload_id: "ontology-skill-enhancement-20260126"
contextFile: ".agent/prompts/ontology-skill-enhancement-20260126/_context.yaml"
progressFile: ".agent/prompts/ontology-skill-enhancement-20260126/_progress.yaml"

# =============================================================================
# MY SCOPE
# =============================================================================

scope:
  phaseId: "phase2-why-enhancement"
  phaseName: "/ontology-why Integrity ë¶„ì„ ê°•í™”"
  priority: "P0"
  description: |
    í˜„ì¬ í˜•ì‹ ìœ„ì£¼ì˜ ì¶œë ¥ì„ 5ê°€ì§€ Ontology Integrity ê´€ì 
    ìƒì„¸ ë¶„ì„ìœ¼ë¡œ ê°•í™”.

    í•µì‹¬ ë³€ê²½ì‚¬í•­:
    1. 5ê°€ì§€ Integrity ê´€ì  êµ¬ì¡°í™”
    2. ì¶œë ¥ í˜•ì‹ì— ëª¨ë“  ê´€ì  í¬í•¨
    3. WebSearch/Context7 í†µí•©ìœ¼ë¡œ ì‹¤ì‹œê°„ ë¬¸ì„œ ê²€ìƒ‰

# =============================================================================
# TARGET FILES (I can MODIFY these)
# =============================================================================

targetFiles:
  - path: ".claude/skills/ontology-why/SKILL.md"
    readOnly: false
    sections:
      - "Section 3.2: Integrity ê´€ì  í™•ì¥"
      - "Section 5: Output Format ê°•í™”"
      - "Section 7: Tools - WebSearch í†µí•©"
    modifications:
      - "Add detailed 5 Integrity perspectives structure"
      - "Expand output format to include all 5 perspectives"
      - "Add WebSearch integration for Palantir docs"
      - "Add Context7 MCP query examples"

# =============================================================================
# REFERENCE FILES (I can only READ these)
# =============================================================================

referenceFiles:
  - path: "/home/palantir/park-kyungchan/palantir/docs/ObjectType_Reference.md"
    reason: "Integrity ê´€ì  ì •ì˜ ì°¸ì¡°"

  - path: ".agent/prompts/ontology-skill-enhancement-20260126/research.md"
    reason: "Gap ë¶„ì„ + êµ¬í˜„ ê¶Œì¥ì‚¬í•­ (3.4 Ontology-Why Enhancement Details)"

# =============================================================================
# DEPENDENCIES
# =============================================================================

dependencies: []
blockedBy: []
canStartImmediately: true

# =============================================================================
# IMPLEMENTATION GUIDE
# =============================================================================

implementationGuide:
  integrityPerspectives:
    - id: 1
      name: "Immutability (ë¶ˆë³€ì„±)"
      description: "PK/ì‹ë³„ìëŠ” ê°ì²´ ìƒì„± í›„ ì ˆëŒ€ ë³€ê²½ ë¶ˆê°€í•´ì•¼ í•¨"
      questions:
        - "ì™œ PKë¥¼ Stringìœ¼ë¡œ?"
        - "ì™œ autoincrement ê¸ˆì§€?"
      analysis:
        - "PK ë³€ê²½ ì‹œ ëª¨ë“  edits ì†ì‹¤"
        - "ì—°ê²°ëœ links ì‚¬ë¼ì§"
        - "íˆìŠ¤í† ë¦¬ ì¶”ì  ë¶ˆê°€"

    - id: 2
      name: "Determinism (ê²°ì •ì„±)"
      description: "ë™ì¼ ì…ë ¥ â†’ í•­ìƒ ë™ì¼ ì¶œë ¥ ë³´ì¥"
      questions:
        - "ì™œ composite keyì— ìˆœì„œê°€ ì¤‘ìš”?"
        - "ì™œ hashë¥¼ ì‚¬ìš©?"
      analysis:
        - "Foundry ë¹Œë“œ ì‹œ PK ë³€ê²½ë˜ë©´ ë°ì´í„° ë¬´ê²°ì„± ê¹¨ì§"
        - "ê²°ì •ë¡ ì  ìƒì„±ì´ ì¬í˜„ ê°€ëŠ¥ì„± ë³´ì¥"

    - id: 3
      name: "Referential Integrity (ì°¸ì¡° ë¬´ê²°ì„±)"
      description: "Linkê°€ ê¹¨ì§€ì§€ ì•ŠëŠ” êµ¬ì¡°"
      questions:
        - "ì™œ FKê°€ Many sideì—?"
        - "ì™œ CASCADE ì •ì±…?"
      analysis:
        - "Link ì°¸ì¡°ê°€ í•­ìƒ ìœ íš¨í•´ì•¼ í•¨"
        - "ì‚­ì œ ì‹œ ì—°ì‡„ ì˜í–¥ ê³ ë ¤"

    - id: 4
      name: "Semantic Consistency (ì˜ë¯¸ë¡ ì  ì¼ê´€ì„±)"
      description: "íƒ€ì…/ì œì•½ì˜ ë¹„ì¦ˆë‹ˆìŠ¤ ì˜ë¯¸"
      questions:
        - "ì™œ DATE vs TIMESTAMP?"
        - "ì™œ unique=True?"
      analysis:
        - "ë°ì´í„° íƒ€ì…ì´ ë¹„ì¦ˆë‹ˆìŠ¤ ì˜ë¯¸ì™€ ì¼ì¹˜í•´ì•¼ í•¨"
        - "ì œì•½ì¡°ê±´ì´ ë¹„ì¦ˆë‹ˆìŠ¤ ê·œì¹™ì„ ë°˜ì˜"

    - id: 5
      name: "Lifecycle Management (ìƒëª…ì£¼ê¸° ê´€ë¦¬)"
      description: "ìƒíƒœ ë³€ê²½, ì‚­ì œ ì‹œ ì˜í–¥"
      questions:
        - "ì™œ DEPRECATED ìƒíƒœ?"
        - "ì™œ soft delete?"
      analysis:
        - "ìƒíƒœ ë³€ê²½ì´ ê´€ë ¨ ê°ì²´ì— ë¯¸ì¹˜ëŠ” ì˜í–¥"
        - "ì‚­ì œ ëŒ€ì‹  ìƒíƒœ ë³€ê²½ ê¶Œì¥"

  outputFormat:
    template: |
      â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
      â•‘  ğŸ” Ontology Integrity ë¶„ì„: {subject}                        â•‘
      â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£
      â•‘  Q: {user_question}                                           â•‘
      â•‘                                                               â•‘
      â•‘  ğŸ“ 1. Immutability (ë¶ˆë³€ì„±)                                  â•‘
      â•‘     - {analysis}                                              â•‘
      â•‘                                                               â•‘
      â•‘  ğŸ“ 2. Determinism (ê²°ì •ì„±)                                   â•‘
      â•‘     - {analysis}                                              â•‘
      â•‘                                                               â•‘
      â•‘  ğŸ“ 3. Referential Integrity (ì°¸ì¡° ë¬´ê²°ì„±)                    â•‘
      â•‘     - {analysis}                                              â•‘
      â•‘                                                               â•‘
      â•‘  ğŸ“ 4. Semantic Consistency (ì˜ë¯¸ë¡ ì  ì¼ê´€ì„±)                 â•‘
      â•‘     - {analysis}                                              â•‘
      â•‘                                                               â•‘
      â•‘  ğŸ“ 5. Lifecycle Management (ìƒëª…ì£¼ê¸° ê´€ë¦¬)                   â•‘
      â•‘     - {analysis}                                              â•‘
      â•‘                                                               â•‘
      â•‘  ğŸ“š Palantir ê³µì‹ ê·¼ê±°:                                       â•‘
      â•‘  "{citation}"                                                 â•‘
      â•‘  ğŸ”— {source_url}                                              â•‘
      â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

  externalSearch:
    webSearch:
      query: "site:palantir.com/docs {topic}"
      trustedDomains:
        - "palantir.com"
        - "github.com/palantir"
        - "foundry.palantir.com"
    context7:
      example: |
        mcp__context7__resolve-library-id:
          libraryName: "palantir foundry"
          query: "primary key string type ontology"
        mcp__context7__query-docs:
          libraryId: "/palantir/foundry-docs"
          query: "why primary key must be string"

# =============================================================================
# COMPLETION CRITERIA
# =============================================================================

completionCriteria:
  required:
    - "5ê°€ì§€ Integrity ê´€ì  ìƒì„¸ ì •ì˜ í¬í•¨"
    - "ì¶œë ¥ í˜•ì‹ì— ëª¨ë“  5ê°œ ê´€ì  ì„¹ì…˜ í¬í•¨"
    - "WebSearch í˜¸ì¶œ ë¡œì§ ëª…ì„¸ í¬í•¨"
    - "Context7 MCP ì¿¼ë¦¬ ì˜ˆì‹œ í¬í•¨"
    - "Palantir ê³µì‹ ë¬¸ì„œ URL ìˆ˜ì§‘ ë¡œì§"

  verification:
    - command: "grep -c 'Immutability\\|Determinism\\|Referential Integrity\\|Semantic Consistency\\|Lifecycle' .claude/skills/ontology-why/SKILL.md"
      expected: "5 ì´ìƒ"
    - command: "grep -c 'WebSearch\\|mcp__context7' .claude/skills/ontology-why/SKILL.md"
      expected: "2 ì´ìƒ"

# =============================================================================
# OUTPUT FORMAT
# =============================================================================

outputFormat: "L1/L2/L3"
l2OutputPath: ".agent/prompts/ontology-skill-enhancement-20260126/outputs/phase2-why-enhancement.md"

# =============================================================================
# ON COMPLETE
# =============================================================================

onComplete:
  - "TaskUpdate(taskId='2', status='completed')"
  - "Update _progress.yaml: phase2-why-enhancement.status = 'completed'"
  - "Move this file to completed/ directory"
  - "Report L1 summary to Orchestrator"
  - "Notify phase4-integration-test that dependency is resolved"
