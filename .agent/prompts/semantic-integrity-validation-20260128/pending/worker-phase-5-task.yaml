# =============================================================================
# Worker Task: Phase 5 - Integration Testing & Documentation
# =============================================================================

taskId: "phase5-integration-test"
nativeTaskId: "13"
assignedTo: "unassigned"
orchestrator: "orchestrate"
createdAt: "2026-01-28T19:55:00+09:00"

# =============================================================================
# CONTEXT REFERENCE
# =============================================================================
workload_id: "semantic_integrity_validation_20260128_193000"
contextFile: ".agent/prompts/semantic-integrity-validation-20260128/_context.yaml"
progressFile: ".agent/prompts/semantic-integrity-validation-20260128/_progress.yaml"

# =============================================================================
# MY SCOPE
# =============================================================================
scope:
  phaseId: "phase5-integration-test"
  phaseName: "Integration Testing & Documentation"
  description: |
    전체 통합 테스트 및 문서 업데이트.
    실제 워크플로우에서 변조 감지 시나리오 검증.

# =============================================================================
# TARGET FILES
# =============================================================================
targetFiles:
  - path: ".claude/skills/collect/SKILL.md"
    action: "modify"
    sections:
      - "Version History 업데이트 (V5.0)"
      - "Testing Checklist에 Semantic Integrity 항목 추가"

  - path: ".agent/prompts/semantic-integrity-validation-20260128/test-results.md"
    action: "create"
    sections:
      - "테스트 시나리오 및 결과"

# =============================================================================
# REFERENCE FILES
# =============================================================================
referenceFiles:
  - path: ".claude/skills/collect/SKILL.md"
    reason: "기존 Testing Checklist 참조"

# =============================================================================
# DEPENDENCIES
# =============================================================================
dependencies: ["phase4-review-gate-enhance"]
blockedBy: ["12"]
canStartImmediately: false

waitCondition: |
  Check _progress.yaml
  If phase4-review-gate-enhance.status == 'completed', proceed
  Otherwise, wait

# =============================================================================
# COMPLETION CRITERIA
# =============================================================================
completionCriteria:
  required:
    - "정상 케이스: 모든 해시 일치 → APPROVED"
    - "변조 케이스: 해시 불일치 → BLOCK_SYNTHESIS"
    - "체인 단절: upstream 변경 → STALE 경고"
    - "Version History에 V5.0 변경사항 기록"

  verification:
    - command: "grep 'V5.0\\|5.0.0' .claude/skills/collect/SKILL.md"
      expected: "Version 5.0 documented"

# =============================================================================
# TEST SCENARIOS
# =============================================================================
testScenarios:
  - name: "Normal Case - All Hashes Match"
    setup: "Run /worker to generate manifest, don't modify files"
    expected: "APPROVED, integrity_rate = 1.0"

  - name: "Tamper Case - Hash Mismatch"
    setup: "After /worker, manually edit an output file"
    expected: "BLOCK_SYNTHESIS, tamper_alert generated"

  - name: "Chain Break - Upstream Changed"
    setup: "Modify clarify.yaml after worker completion"
    expected: "STALE warning, chain_verification shows break"

# =============================================================================
# OUTPUT FORMAT
# =============================================================================
outputFormat: "L1/L2/L3"
l2OutputPath: ".agent/prompts/semantic-integrity-validation-20260128/outputs/phase5-output.md"

# =============================================================================
# ON COMPLETE
# =============================================================================
onComplete:
  - "TaskUpdate(taskId='13', status='completed')"
  - "Update _progress.yaml: phase5-integration-test.status = 'completed'"
  - "Report to Orchestrator with final L1 summary"
  - "Mark workload as complete"
