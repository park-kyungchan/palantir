{
  "id": "b4a43418-48c6-4b1b-b84f-a921f1e0a743",
  "type": "Plan",
  "created_at": "2026-01-08T07:33:09.395405Z",
  "meta_version": 1,
  "plan_id": "plan_hwpx_docling_mathpix_20260108_073309",
  "objective": "Resolve Docling UTF-8 decode failure and model access issues in HWPX pipeline; define Mathpix vs Docling strategy while staying OWPML-only.",
  "ontology_impact": [
    "HWPX Pipeline",
    "OWPML Builder",
    "Ingestor Strategy",
    "OCR/Mathpix",
    "Layout Detection"
  ],
  "research_context": {
    "constraints": [
      "OWPML-only output (no Automation/HAction)",
      "LLM-independent execution (schema-first ODA)",
      "Network expected to be available"
    ],
    "recent_changes": [
      "Removed Automation executor/bridge and action DB",
      "convert_pipeline.py builds HWPX via HwpxDocumentBuilder",
      "IngestorFactory default set to Docling only"
    ],
    "observed_errors": [
      "Docling preprocess failed: utf-8 decode byte 0xb9 on sample.pdf",
      "Fallback path attempted model download; HuggingFace DNS failures",
      "EasyOCR fallback triggered; surya missing"
    ]
  },
  "jobs": [
    {
      "id": "job_hwpx_docling_mathpix_01",
      "action_name": "deep_investigation_and_fix",
      "action_args": {
        "target": "/home/palantir/hwpx",
        "pdf": "/home/palantir/hwpx/sample.pdf",
        "output": "/home/palantir/hwpx/sample_e2e.hwpx",
        "ingestor_default": "docling",
        "constraints": [
          "OWPML-only output",
          "No Automation/HAction",
          "Schema-first ODA compliance"
        ]
      },
      "description": "Investigate Docling UTF-8 decode error and model access issues. Propose and implement a fix (Docling config, preprocessing, or Mathpix integration) that preserves OWPML-only pipeline output. Provide clear execution steps and verification logs.",
      "input_context": [
        "/home/palantir/hwpx/convert_pipeline.py",
        "/home/palantir/hwpx/lib/ingestors/factory.py",
        "/home/palantir/hwpx/lib/ingestors/docling_ingestor.py",
        "/home/palantir/hwpx/lib/ingestors/pymupdf_ingestor.py",
        "/home/palantir/hwpx/lib/layout/detector.py",
        "/home/palantir/hwpx/lib/ocr/manager.py",
        "/home/palantir/hwpx/lib/ocr/engine.py",
        "/home/palantir/hwpx/lib/compiler.py",
        "/home/palantir/hwpx/lib/owpml/document_builder.py",
        "/home/palantir/hwpx/lib/owpml/package_normalizer.py",
        "/home/palantir/hwpx/docs/ActionTable_2504.pdf",
        "/home/palantir/hwpx/docs/HwpAutomation_2504.pdf",
        "/home/palantir/hwpx/docs/ParameterSetTable_2504.pdf",
        "/home/palantir/hwpx/docs/한글오토메이션EventHandler추가_2504.pdf",
        "/home/palantir/hwpx/docs/OWPML_HWPX_technical_reference_for_AI_agent_framework.md",
        "/home/palantir/hwpx/sample.pdf"
      ],
      "evidence": "E2E run with Docling failed utf-8 decode; fallback attempted HF model download; OWPML-only pipeline now builds HWPX via HwpxDocumentBuilder; user wants Mathpix to resolve text decoding while keeping OWPML-only output."
    }
  ]
}